{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./resources/assets/js/main.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","kanaDict","$","ajaxSetup","headers","attr","dataType","processData","contentType","timeout","currentStr","currentRomaji","currentChar","score","strike","damage","mistakeDamage","judgeDrop","judgeHaving","timeRemaining","attackTimer","questions","player","monster","dropItem","user","field","havingItems","equipItem","victoryCnt","nextFieldFlag1","nextFieldFlag2","nextFieldFlag3","nextFieldFlag4","fieldData","FormData","status","displayEnter","readyTime","words","wordsKana","separationKana","separationRomaji","aditionalDict","charNum","correctCount","mistakeCount","judgeTyping","finishRomaji","flagN","levelUpCount","bonusPoint","judgeEnter","infoFlag","getData","ajax","url","type","data","done","response","number","having_items","equip_item","text","level","hp","id","field1_victory_count","field2_victory_count","field3_victory_count","field4_victory_count","field5_victory_count","victoryCount","parseInt","Math","random","monsters","dropItems","setPlayerStatus","player_image","image","css","hide","html","show","fail","console","log","append","textScroll","attack","defence","min_attack","mistake_damage","setQuestion","length","returnRomaji","returnAditionalDict","judgeN","aditionalList","push","indexOf","strList","j","wordChangeRomaji","kana","returnKana","judgeChar","beforeKana","pop","wordSeparation","join","shift","charInsort","charAt","typing","keyStr","collationList","remainingList","returnAnotherList","startsWith","correctType","currentTime","play","substr","pause","volume","ceil","victory","missType","slice","gameover","anotherList","nextStr","unshift","nextRomaji","monsterAttackCount","attack_interval","clearInterval","setInterval","monsterAttack","divideBonusPoint","get_item","selectNextAction","prop","setEquip","removeClass","filter","this","addClass","releaseField","nextExp","currentLv","battle_text","scroll","scrollHeight","on","e","preventDefault","val","word","word_kana","readyTimer","loop","ready","trigger","exp","havingItemsId","inArray","next_exp","addExp","getExp","levelUp","growHp","addStatusSelect","JSON","stringify","document","itemId","item","items","empty"],"mappings":"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","file":"/js/main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 41);\n","//かな辞書 kanaDictionary\r\nconst kanaDict = {\r\n    \"あ\":[\"a\"], \"い\":[\"i\",\"yi\"], \"う\":[\"u\",\"wu\",\"whu\"], \"え\":[\"e\"], \"お\":[\"o\"],\r\n    \"か\":[\"ka\",\"ca\"], \"き\":[\"ki\"], \"く\":[\"ku\",\"cu\",\"qu\"], \"け\":[\"ke\"], \"こ\":[\"ko\",\"co\"],\r\n    \"さ\":[\"sa\"],\"し\":[\"si\",\"ci\",\"shi\"],\"す\":[\"su\"],\"せ\":[\"se\",\"ce\"],\"そ\":[\"so\"],\r\n    \"た\":[\"ta\"],\"ち\":[\"ti\",\"chi\"],\"つ\":[\"tu\",\"tsu\"],\"て\":[\"te\"],\"と\":[\"to\"],\r\n    \"な\":[\"na\"],\"に\":[\"ni\"],\"ぬ\":[\"nu\"],\"ね\":[\"ne\"],\"の\":[\"no\"],\r\n    \"は\":[\"ha\"],\"ひ\":[\"hi\"],\"ふ\":[\"hu\",\"fu\"],\"へ\":[\"he\"],\"ほ\":[\"ho\"],\r\n    \"ま\":[\"ma\"],\"み\":[\"mi\"],\"む\":[\"mu\"],\"め\":[\"me\"],\"も\":[\"mo\"],\r\n    \"や\":[\"ya\"],\"ゆ\":[\"yu\"],\"よ\":[\"yo\"],\r\n    \"ら\":[\"ra\"],\"り\":[\"ri\"],\"る\":[\"ru\"],\"れ\":[\"re\"],\"ろ\":[\"ro\"],\r\n    \"わ\":[\"wa\"],\"を\":[\"wo\"],\"ん\":[\"n\",\"nn\",\"xn\"],\r\n    \"が\":[\"ga\"],\"ぎ\":[\"gi\"],\"ぐ\":[\"gu\"],\"げ\":[\"ge\"],\"ご\":[\"go\"],\r\n    \"ざ\":[\"za\"],\"じ\":[\"zi\",\"ji\"],\"ず\":[\"zu\"],\"ぜ\":[\"ze\"],\"ぞ\":[\"zo\"],\r\n    \"だ\":[\"da\"],\"ぢ\":[\"di\"],\"づ\":[\"du\"],\"で\":[\"de\"],\"ど\":[\"do\"],\r\n    \"ば\":[\"ba\"],\"び\":[\"bi\"],\"ぶ\":[\"bu\"],\"べ\":[\"be\"],\"ぼ\":[\"bo\"],\r\n    \"ぱ\":[\"pa\"],\"ぴ\":[\"pi\"],\"ぷ\":[\"pu\"],\"ぺ\":[\"pe\"],\"ぽ\":[\"po\"],\r\n    \"きゃ\":[\"kya\",\"kilya\",\"kixya\"],\"きぃ\":[\"kyi\",\"kili\",\"kixi\",\"kilyi\",\"kixyi\"],\"きゅ\":[\"kyu\",\"kilyu\",\"kixyu\"],\"きぇ\":[\"kye\",\"kile\",\"kixe\",\"kilye\",\"kixye\"],\"きょ\":[\"kyo\",\"kilyo\",\"kixyo\"],\r\n    \"ぎゃ\":[\"gya\",\"gilya\",\"gixya\"],\"ぎぃ\":[\"gyi\",\"gili\",\"gixi\",\"gilyi\",\"gixyi\"],\"ぎゅ\":[\"gyu\",\"gilyu\",\"gixyu\"],\"ぎぇ\":[\"gye\",\"gile\",\"gixe\",\"gilye\",\"gixye\"],\"ぎょ\":[\"gyo\",\"gilyo\",\"gixyo\"],\r\n    \"しゃ\":[\"sya\",\"sha\",\"sixya\",\"silya\",\"shixya\",\"shilya\",\"cixya\",\"cilya\"],\"しぃ\":[\"syi\",\"sili\",\"sixi\",\"silyi\",\"sixyi\",\"shixi\",\"shili\",\"cixi\",\"cili\"],\"しゅ\":[\"syu\",\"shu\",\"silyu\",\"sixyu\",\"shixyu\",\"shilyu\",\"cixyu\",\"cilyu\"],\"しぇ\":[\"she\",\"sye\",\"sile\",\"sixe\",\"silye\",\"sixye\",\"shixe\",\"shile\",\"cixe\",\"cile\"],\"しょ\":[\"syo\",\"sho\",\"silyo\",\"sixyo\",\"shixyo\",\"shilyo\",\"cixyo\",\"cilyo\"],\r\n    \"じゃ\":[\"ja\",\"zya\",\"jya\",\"zilya\",\"zixya\",\"jilya\",\"jixya\"],\"じぃ\":[\"zyi\",\"jyi\",\"zili\",\"zixi\",\"jili\",\"jixi\",\"zilyi\",\"zixyi\",\"jilyi\",\"jixyi\"],\"じゅ\":[\"zyu\",\"ju\",\"jyu\",\"zixyu\",\"zilyu\",\"jixyu\",\"jilyu\"],\"じぇ\":[\"zye\",\"je\",\"jye\",\"zixe\",\"zile\",\"jixe\",\"jile\"],\"じょ\":[\"zyo\",\"jo\",\"jyo\",\"zixyo\",\"zilyo\",\"jixyo\",\"jilyo\"],\r\n    \"ちゃ\":[\"tya\",\"cha\",\"cya\",\"tixya\",\"tilya\",\"chixya\",\"chilya\"],\"ちぃ\":[\"tyi\",\"cyi\",\"tixi\",\"tili\",\"chixi\",\"chili\"],\"ちゅ\":[\"tyu\",\"chu\",\"cyu\",\"tixyu\",\"tilyu\",\"chixyu\",\"chilyu\"],\"ちぇ\":[\"tye\",\"che\",\"cye\",\"tixe\",\"tile\",\"chixe\",\"chile\"],\"ちょ\":[\"tyo\",\"cho\",\"cyo\",\"tixyo\",\"tilyo\",\"chixyo\",\"chilyo\"],\r\n    \"にゃ\":[\"nya\",\"nixya\",\"nilya\"],\"にぃ\":[\"nyi\",\"nixi\",\"nili\"],\"にゅ\":[\"nyu\",\"nixyu\",\"nilyu\"],\"にぇ\":[\"nye\",\"nixe\",\"nile\"],\"にょ\":[\"nyo\",\"nixyo\",\"nilyo\"],\r\n    \"ひゃ\":[\"hya\",\"hixya\",\"hilya\"],\"ひぃ\":[\"hyi\",\"hixi\",\"hili\"],\"ひゅ\":[\"hyu\",\"hixyu\",\"hilyu\"],\"ひぇ\":[\"hye\",\"hixe\",\"hile\"],\"ひょ\":[\"hyo\",\"hixyo\",\"hilyo\"],\r\n    \"ふぁ\":[\"fa\",\"fwa\",\"fuxa\",\"fula\",\"huxa\",\"hula\"],\"ふぃ\":[\"fi\",\"fwi\",\"fyi\",\"fuxi\",\"fuli\",\"huxi\",\"huli\"],\"ふぅ\":[\"fwu\",\"fuxu\",\"fulu\",\"huxu\",\"hulu\"],\"ふぇ\":[\"fe\",\"fwe\",\"fye\",\"fuxe\",\"fule\",\"huxe\",\"hule\"],\"ふぉ\":[\"fo\",\"fwo\",\"fuxo\",\"fulo\",\"huxo\",\"hulo\"],\r\n    \"くぁ\":[\"qwa\",\"qa\",\"kwa\",\"kuxa\",\"kula\",\"quxa\",\"qula\",\"cuxa\",\"cula\"],\"くぃ\":[\"qwi\",\"qi\",\"qyi\",\"kuxi\",\"kuli\",\"quxi\",\"quli\",\"cuxi\",\"culi\"],\"くぅ\":[\"qwu\",\"kuxu\",\"kulu\",\"quxu\",\"qulu\",\"cuxu\",\"culu\"],\"くぇ\":[\"qwe\",\"qe\",\"qye\",\"kuxe\",\"kule\",\"quxe\",\"qule\",\"cuxe\",\"cule\"],\"くぉ\":[\"qwo\",\"qo\",\"kuxo\",\"kulo\",\"quxo\",\"qulo\",\"cuxo\",\"culo\"],\r\n    \"ぐぁ\":[\"gya\",\"guxa\",\"gula\"],\"ぐぃ\":[\"gyi\",\"guxi\",\"guli\"],\"ぐぅ\":[\"gyu\",\"guxu\",\"gulu\"],\"ぐぇ\":[\"gye\",\"guxe\",\"gule\"],\"ぐぉ\":[\"gyo\",\"guxo\",\"gulo\"],\r\n    \"すぁ\":[\"swa\",\"suxa\",\"sula\"],\"すぃ\":[\"swi\",\"suxi\",\"suli\"],\"すぅ\":[\"swu\",\"suxu\",\"sulu\"],\"すぇ\":[\"swe\",\"suxe\",\"sule\"],\"すぉ\":[\"swo\",\"suxo\",\"sulo\"],\r\n    \"てゃ\":[\"tha\",\"texya\",\"telya\"],\"てぃ\":[\"thi\",\"texi\",\"teli\"],\"てゅ\":[\"thu\",\"texyu\",\"telyu\"],\"てぇ\":[\"the\",\"texe\",\"tele\"],\"てょ\":[\"tho\",\"texyo\",\"telyo\"],\r\n    \"とぁ\":[\"twa\"],\"とぃ\":[\"twi\"],\"とぅ\":[\"twu\",\"toxu\",\"tolu\"],\"とぇ\":[\"twe\"],\"とぉ\":[\"two\",\"toxo\",\"tolo\"],\r\n    \"ぢゃ\":[\"dya\",\"dixya\",\"dilya\"],\"ぢぃ\":[\"dyi\"],\"ぢゅ\":[\"dyu\"],\"ぢぇ\":[\"dye\"],\"ぢょ\":[\"dyo\"],\r\n    \"でゃ\":[\"dha\"],\"でぃ\":[\"dhi\",\"dexi\",\"deli\"],\"でゅ\":[\"dhu\",\"dexyu\",\"delyu\"],\"でぇ\":[\"dhe\"],\"でょ\":[\"dho\"],\r\n    \"どぁ\":[\"dwa\"],\"どぃ\":[\"dwi\"],\"どぅ\":[\"dwu\",\"doxu\",\"dolu\"],\"どぇ\":[\"dwe\"],\"どぉ\":[\"dwo\"],\r\n    \"びゃ\":[\"bya\",\"bixya\",\"bilya\"],\"びぃ\":[\"byi\"],\"びゅ\":[\"byu\",\"bixyu\",\"bilyu\"],\"びぇ\":[\"bye\"],\"びょ\":[\"byo\",\"bixyo\",\"bilyo\"],\r\n    \"ぴゃ\":[\"pya\",\"pixya\",\"pilya\"],\"ぴぃ\":[\"pyi\"],\"ぴゅ\":[\"pyu\",\"pixyu\",\"pilyu\"],\"ぴぇ\":[\"pye\"],\"ぴょ\":[\"pyo\",\"pixyo\",\"pilyo\"],\r\n    \"りゃ\":[\"rya\",\"rixya\",\"rilya\"],\"りゅ\":[\"ryu\",\"rixyu\",\"rilyu\"],\"りょ\":[\"ryo\",\"rixyo\",\"rilyo\"],\r\n    \"ー\":[\"-\"],\" \":[\" \"],\"、\":[\",\"],\"？\":[\"?\"],\"！\":[\"!\"],\"。\":[\".\"],\r\n    \"っ\":[\"xtu\",\"ltu\",\"xtsu\",\"ltsu\"],\r\n    \"ぁ\":[\"xa\",\"la\"],\r\n    \"ぇ\":[\"xe\",\"le\"],\r\n    \"ゃ\":[\"lya\",\"xya\"],\"ゅ\":[\"xyu\",\"lyu\"],\"ょ\":[\"lyo\",\"xyo\"],\r\n    \"a\":\"a\",\"b\":\"b\",\"c\":\"c\",\"d\":\"d\",\"e\":\"e\",\"f\":\"f\",\"g\":\"g\",\"h\":\"h\",\"i\":\"i\",\"j\":\"j\",\"k\":\"k\",\"l\":\"l\",\"m\":\"m\",\"n\":\"n\",\r\n    \"o\":\"o\",\"p\":\"p\",\"q\":\"q\",\"r\":\"r\",\"s\":\"s\",\"t\":\"t\",\"u\":\"u\",\"v\":\"v\",\"w\":\"w\",\"x\":\"x\",\"y\":\"y\",\"z\":\"z\",\r\n    \"\":\"\",\",\":\",\"\r\n}\r\n\r\n$(function() {\r\n\r\n    //ajax通信のセットアップ\r\n    $.ajaxSetup({\r\n        headers: {\r\n            'X-CSRF-TOKEN' : $('meta[name=\"csrf-token\"]').attr('content')\r\n        },\r\n        dataType: 'json',\r\n        processData: false,\r\n        contentType: false,\r\n        timeout: 10000,\r\n    });\r\n\r\n    //各取得データを保持する為の変数\r\n    let questions = [];\r\n    let player = [];\r\n    let monster = [];\r\n    let dropItem = [];\r\n    let user = [];\r\n    let field = [];\r\n    let havingItems = [];\r\n    let equipItem = [];\r\n    //勝利数を保持する変数\r\n    let victoryCnt = 0;\r\n    //フィールド解放フラグ\r\n    let nextFieldFlag1 = 0;\r\n    let nextFieldFlag2 = 0;\r\n    let nextFieldFlag3 = 0;\r\n    let nextFieldFlag4 = 0;\r\n    //選択したフィールドの値を保持しておく変数\r\n    let fieldData = new FormData();\r\n    //現在の画面ステータスを管理する\r\n    //0:フィールド選択中, 1:バトル開始前, 2:バトル中, 3:バトル勝利, 4:バトル敗北,またはバトル後の選択画面\r\n    let status = 0;\r\n    //勝利後のテキストスクロールに利用\r\n    let displayEnter = 0;\r\n    //バトル開始前のカウントダウン用\r\n    let readyTime = 3;\r\n    //questionsの各値を格納しておく変数\r\n    let words = [];\r\n    let wordsKana = [];\r\n    //問題文を区切って格納する為の変数\r\n    let separationKana = [];\r\n    let separationRomaji = [];\r\n    //あいまい入力用の一時的な辞書として利用する為の変数\r\n    let aditionalDict = [];\r\n    //入力対象を格納する為の変数\r\n    let currentStr,currentRomaji,currentChar;\r\n    //入力対象を判定する為の変数\r\n    let charNum = 0;\r\n    //正解数とミス数をカウントする変数\r\n    let correctCount = 0;\r\n    let mistakeCount = 0;\r\n    //スコア\r\n    let score;\r\n    //playerが与えるダメージ\r\n    let strike;\r\n    //playerが受けるダメージ\r\n    let damage;\r\n    //タイプミス時のダメージ\r\n    let mistakeDamage;\r\n    //\r\n    let judgeTyping = [];\r\n    let finishRomaji = [];\r\n    //\r\n    let flagN = 0;\r\n    //レベルアップ判定に利用\r\n    let levelUpCount = 0;\r\n    let bonusPoint = 0;\r\n    //アイテムドロップの判定に利用\r\n    let judgeDrop;\r\n    let judgeHaving;\r\n    let timeRemaining;\r\n    let attackTimer;\r\n    //バトル後のテキスト処理時にEnterキーが連打されるのを防ぐ為の変数\r\n    let judgeEnter = 0;\r\n    let infoFlag = 0;\r\n\r\n\r\n\r\n    //以下フィールド選択～バトル開始前の処理 status=0\r\n\r\n    //フィールドを選択した際の処理\r\n    $('.field_btn').on('click', function(e) {\r\n        e.preventDefault();\r\n\r\n\r\n        $('#battle_text').append(\"<br>\" + \"通信中・・・\")\r\n\r\n        fieldData.append('field_id', $(this).val());\r\n\r\n        getData();\r\n    });\r\n\r\n    //バトルを開始するのに必要なデータを取得する\r\n    function getData() {\r\n        $.ajax({\r\n            url: '/getdata',\r\n            type: 'POST',\r\n            data: fieldData,\r\n        })\r\n        .done(function(response) {\r\n            //各値を保持する\r\n            questions = response.questions;\r\n            player = response.player;\r\n            user = response.user;\r\n            field = response.field;\r\n            havingItems = response.having_items;\r\n            equipItem = response.equip_item;\r\n\r\n            //各値のセット\r\n            $('.player_name').text(user.name);\r\n            $('.player_level').text(player.level);\r\n            $('#player_hp').text(player.hp);\r\n            \r\n            let number;\r\n            victoryCnt = victoryCount();\r\n            if(victoryCnt < 5) {\r\n                number = parseInt(Math.random() * victoryCnt);\r\n            }else {\r\n                number = parseInt(Math.random() * 5);\r\n            }\r\n            \r\n            monster = response.monsters[number];\r\n            dropItem = response.dropItems[number];\r\n\r\n            $('.monster_name').text(monster.name);\r\n            $('#monster_hp').text(monster.hp);\r\n\r\n            //プレイヤーのステータス設定処理\r\n            setPlayerStatus();\r\n            \r\n            if(player.player_image == 1) {\r\n                $('.player_image').attr('src', '/images/player_images/主人公男h150.png');\r\n            }else {\r\n                $('.player_image').attr('src', '/images/player_images/主人公女h150.png');\r\n            }\r\n\r\n            $('.monster_image').attr('src', '/images/monster_images/' + monster.image);\r\n\r\n            $('.rpg_display').css('background-image', 'url(/images/field_images/' + field.image + ')');\r\n\r\n            $('.select_field_display').hide();\r\n            $('#battle_text').html(monster.name + 'があらわれた！' + \"<br>\" + 'BATTLE STARTボタンをクリック または スペースキーを押して戦闘開始' + \"<br>\" + '※ サウンドが流れます');\r\n            $('#battle_btn').show();\r\n            $('#monster_image').css('visibility', 'visible');\r\n            $('#player_image').css('visibility', 'visible');\r\n\r\n            status = 1;\r\n        })\r\n        .fail(function(response) {\r\n            console.log(response);\r\n            $('#battle_text').append(\"<br>通信に失敗しました。\");\r\n            textScroll();\r\n        })\r\n    }\r\n\r\n    //装備アイテムの有無により各ステータスを設定\r\n    function setPlayerStatus() {\r\n\r\n        if(equipItem == null) {\r\n            $('.attack').text(player.attack);\r\n            $('.item_attack').text(0);\r\n            $('.defence').text(player.defence);\r\n            $('.item_defence').text(0);\r\n            $('.mistake_damage').text(1);\r\n            $('.equipment_image').attr('src', '');\r\n\r\n            if((monster.attack - monster.min_attack) < player.defence) {\r\n                damage = monster.min_attack;\r\n            }else {\r\n                damage = monster.attack - player.defence;\r\n            }\r\n            strike = player.attack;\r\n            mistakeDamage = 1;\r\n        }else {\r\n            $('.attack').text(player.attack + equipItem.attack);\r\n            $('.item_attack').text(equipItem.attack);\r\n            $('.defence').text(player.defence + equipItem.defence);\r\n            $('.item_defence').text(equipItem.defence);\r\n            $('.mistake_damage').text(equipItem.mistake_damage);\r\n            $('.equipment_image').attr('src', '/images/item_images/'+equipItem.image);\r\n\r\n            if((monster.attack - monster.min_attack) < (player.defence + equipItem.defence)) {\r\n                damage = monster.min_attack;\r\n            }else {\r\n                damage = monster.attack - (player.defence + equipItem.defence);\r\n            }\r\n            strike = player.attack + equipItem.attack;\r\n            mistakeDamage = equipItem.mistake_damage;\r\n        }\r\n    }\r\n\r\n\r\n\r\n    //以下バトル開始前の処理 status=1\r\n\r\n    //BATTLE STARTボタンを押した際の処理\r\n    $('#battle_btn').on('click', function() {\r\n        $('#battle_btn').hide();\r\n        $('.select_field_display').hide();\r\n        $('.equipment_display').hide();\r\n        $('#selectAudio')[0].play();\r\n        ready();\r\n    });\r\n\r\n    //バトル準備\r\n    function ready() {\r\n        readyTime = 3;\r\n        //問題の出題準備\r\n        for(let i = 0; i < questions.length; i++) {\r\n            words.push(questions[i].word);\r\n            wordsKana.push(questions[i].word_kana);\r\n        }\r\n\r\n        $('#ready_count').show();\r\n        $('#ready_count').text(readyTime);\r\n        //ゲーム開始カウントダウン\r\n        let readyTimer = setInterval(function(){\r\n            $('#ready_count').text(readyTime);\r\n            readyTime--;\r\n            if(readyTime < 0){\r\n                clearInterval(readyTimer);\r\n                readyTime = 3;\r\n                $('#change_equipment_btn').prop('disabled', true);\r\n                $('#change_equipment_btn').css('color', 'lightgray');\r\n                $('#change_field_btn').prop('disabled', true);\r\n                $('#change_field_btn').css('color', 'lightgray');\r\n                gameStart();\r\n            }\r\n        }, 1000);\r\n    }\r\n\r\n    //バトル開始\r\n    function gameStart() {\r\n        $('#ready_count').hide();\r\n        //出題処理\r\n        setQuestion();\r\n        //各値の初期化\r\n        score = 0;\r\n        correctCount = 0;\r\n        mistakeCount = 0;\r\n        //サウンドの再生\r\n        $('#battleAudio')[0].play();\r\n        $('#battleAudio')[0].volume = 0.4;\r\n        $('#battleAudio')[0].loop = true;\r\n        $('.readyVoice')[0].play();\r\n        //monsterの攻撃カウントを開始する\r\n        $('#count').show();\r\n        monsterAttackCount();\r\n        status = 2;\r\n    }\r\n\r\n\r\n\r\n    //以下バトル中の処理 status=2\r\n\r\n    //出題処理\r\n    function setQuestion() {\r\n        //ランダムに出題を行う\r\n        let number = parseInt( Math.random() * words.length );\r\n        $('#word').show();\r\n        $('#word').text(words[number]);\r\n        if(field.id == 2 || field.id == 4) {\r\n            $('#word_kana').text('');            \r\n        }else {\r\n            $('#word_kana').text(wordsKana[number]);\r\n        }\r\n        $('#word_kana').show();\r\n        //ひらがな文字列を分割する\r\n        separationKana = wordSeparation(wordsKana[number]);\r\n        //分割したひらがな文字列をローマ字文字列に変換したものと、例外入力用の追加辞書を作成\r\n        [separationRomaji, aditionalDict] = wordChangeRomaji(separationKana);\r\n\r\n        $('#word_romaji').show();\r\n        $('#word_romaji').text(separationRomaji.join(''));\r\n        //分割済みの問題文の先頭1要素を取り出す\r\n        currentStr = separationKana.shift();\r\n        currentRomaji = separationRomaji.shift();\r\n\r\n        charInsort();\r\n    }\r\n\r\n    //問題文を分割する処理\r\n    function wordSeparation(kana) {\r\n        //returnする文字列を格納する変数\r\n        let returnKana = [];\r\n        //\"っ\"の判定に利用\r\n        let judgeChar = [\"a\", \"i\", \"u\", \"e\", \"o\", \"n\"];\r\n\r\n        //受け取った問題文の文字列を1文字づつ判定\r\n        for(let i = 0; i < kana.length; i++) {\r\n            //小文字の処理\r\n            //先頭文字でなく、1つ前の文字と今回の文字を繋げた文字列がkanaDictにある場合(\"しゃ\"など)\r\n            if(i > 0 && kanaDict[kana[i-1] + kana[i]]) {\r\n                //返す文字列に入れていた最後の要素を取り出す\r\n                let beforeKana = returnKana.pop();\r\n                //最後の要素に今回の文字を連結して1つのブロックとして再度挿入\r\n                returnKana.push(beforeKana + kana[i]);\r\n\r\n            //\"っ\"の処理\r\n            //最後の文字でなく、判定中の文字が\"っ\"であり、次の文字があ行またはな行ではない場合\r\n            }else if(i != kana.length - 1 && kana[i] == \"っ\" && judgeChar.indexOf(kanaDict[kana[i+1]][0][0]) == -1) {\r\n                //次の文字を連結して1つのブロックとして挿入\r\n                returnKana.push(kana[i] + kana[i+1]);\r\n                //次の文字の判定を飛ばす\r\n                i++;\r\n\r\n            //それ以外の通常判定\r\n            }else {\r\n                returnKana.push(kana[i]);\r\n            }\r\n        }\r\n        return returnKana;\r\n    }\r\n\r\n    //分割した問題文をローマ字表記に変換する処理\r\n    function wordChangeRomaji(separationKana) {\r\n        //returnするローマ字文字列\r\n        let returnRomaji = [];\r\n        //returnする例外入力用辞書\r\n        let returnAditionalDict = [];\r\n        //\"ん\"をnnまたはxnと入力しなければならない際の判定に利用\r\n        let judgeN = [\"a\", \"i\", \"u\", \"e\", \"o\", \"y\", \"n\"];\r\n        //あいまい入力の一時的なリスト\r\n        let aditionalList = [];\r\n\r\n        //分割されたブロック毎に判定を行う\r\n        for(let i = 0; i < separationKana.length; i++) {\r\n\r\n            //\"ん\"以外のブロック単位の分割文字列がkanaDictに登録されていた場合\r\n            if(separationKana[i] != \"ん\" && kanaDict[separationKana[i]]) {\r\n                //kanaDictに登録されている打ち方の内、最初の1つを挿入する\r\n                returnRomaji.push(kanaDict[separationKana[i]][0]);\r\n\r\n            //\"ん\"の処理\r\n            //separationKana[i]が\"ん\"であり、文末の場合\r\n            }else if(separationKana[i] == \"ん\" && i == separationKana.length - 1) {\r\n                //nnもしくはxnと入力する必要がある為、kanaDict[\"ん\"]の2番目を挿入する\r\n                returnRomaji.push(kanaDict[separationKana[i]][1]);\r\n\r\n            //separationKana[i]が\"ん\"であり、separationKana[i+1]があ行、な行、や行、\"ん\"の場合\r\n            }else if(i != separationKana.length - 1 && separationKana[i] == \"ん\" && judgeN.indexOf(kanaDict[separationKana[i+1]][0][0]) != -1 ) {\r\n                //nnもしくはxnと入力する必要がある\r\n                returnRomaji.push(kanaDict[separationKana[i]][1]);\r\n\r\n            //それ以外の\"ん\"の処理\r\n            }else if(separationKana[i] == \"ん\") {\r\n                //separationKana[i+1]があ行、な行、や行、\"ん\"でないのでkanaDict[\"ん\"]の最初の打ち方を挿入する\r\n                returnRomaji.push(kanaDict[separationKana[i]][0]);\r\n\r\n            }else {\r\n                //kanaDictに登録されていない場合、分割文字列の最初の1文字を除いた文字列をkanaDictから検索して代入\r\n                strList = separationKana[i].length == 2 ? kanaDict[separationKana[i][1]] : kanaDict[separationKana[i][1] + separationKana[i][2]];\r\n                //strListの要素の数だけ判定を行う\r\n                for(let j = 0; j < strList.length; j++) {\r\n                    //子音部分のローマ字を繰り返すことにより、\"っ\"を表現する\r\n                    aditionalList.push(strList[j][0] + strList[j]);\r\n                }\r\n                //returnAditionalDictに登録\r\n                returnAditionalDict[separationKana[i]] = aditionalList;\r\n                //aditionalDictに登録されている打ち方の内、最初の1つを挿入する\r\n                returnRomaji.push(returnAditionalDict[separationKana[i]][0]);\r\n                //aditionalListの初期化\r\n                aditionalList = [];\r\n            }\r\n        }\r\n        return [returnRomaji, returnAditionalDict];\r\n    }\r\n\r\n    //打キー対象のセット処理\r\n    function charInsort(){\r\n        currentChar = $('#word_romaji').text().charAt(charNum);\r\n    }\r\n\r\n\r\n    //バトル中のタイピング判定処理\r\n    function typing(key) {\r\n        let keyStr = key;\r\n\r\n        if(keyStr == \"Process\") {\r\n            return false;\r\n        }\r\n\r\n        judgeTyping += keyStr;\r\n        finishRomaji += keyStr;\r\n\r\n        //タイプしたキーが正解か不正解か判定\r\n        //表示されているローマ字と同じキーをタイプした場合\r\n        if(keyStr == currentChar){\r\n\r\n            correctType();\r\n            //\r\n            currentRomaji = currentRomaji.slice(1);\r\n\r\n        //flagNが1であり、かつnをタイプした場合も正解とする\r\n        }else if(flagN == 1 && keyStr == \"n\") {\r\n            //表示するローマ字文字列を変更\r\n            $('#word_romaji').text(finishRomaji + currentRomaji + separationRomaji.join(''));\r\n            correctType();\r\n            judgeTyping = \"\";\r\n            flagN = 0;\r\n        \r\n        //表示と異なるキーをタイプした場合\r\n        }else{\r\n            //入力中の文字列がkanaDictにあればremainingListに正解パターンを全て代入し、\r\n            //ない場合はaditionalDictのパターンを代入\r\n            if(kanaDict[currentStr]) {\r\n               remainingList = kanaDict[currentStr];\r\n            }else {\r\n                remainingList = aditionalDict[currentStr];\r\n            }\r\n            //正解パターンと照合を行う\r\n            anotherList = collationList(judgeTyping, remainingList);\r\n            if(anotherList != \"\") {\r\n                currentRomaji = anotherList[0].slice(judgeTyping.length);\r\n                //表示するローマ字文字列を変更\r\n                $('#word_romaji').text(finishRomaji + currentRomaji + separationRomaji.join(''));\r\n                correctType();\r\n\r\n            //\r\n            }else if(currentStr.length >= 2) {\r\n                remainingList = kanaDict[currentStr[0]];\r\n                anotherList = collationList(judgeTyping, remainingList);\r\n\r\n                if(anotherList != \"\") {\r\n                    nextStr = currentStr.slice(1);\r\n                    currentStr = currentStr[0];\r\n                    separationKana.unshift(nextStr);\r\n                    currentRomaji = anotherList[0].slice(judgeTyping.length);\r\n                    nextRomaji = kanaDict[nextStr][0];\r\n                    separationRomaji.unshift(nextRomaji);\r\n\r\n                    $('#word_romaji').text(finishRomaji + currentRomaji + separationRomaji.join(''));\r\n                    correctType();\r\n\r\n                }else if(currentStr.length == 3) {\r\n                    remainingList = aditionalDict[currentStr];\r\n                    anotherList = collationList(judgeTyping, remainingList);\r\n\r\n                    if(anotherList != \"\") {\r\n                        nextStr = currentStr[2];\r\n                        currentStr.pop();\r\n                        separationKana.unshift(nextStr);\r\n                        currentRomaji = anotherList[0].slice(judgeTyping.length);\r\n                        nextRomaji = kanaDict[nextStr][0];\r\n                        separationRomaji.unshift(nextRomaji);\r\n\r\n                        $('#word_romaji').text(finishRomaji + currentRomaji + separationRomaji.join(''));\r\n                        correctType();\r\n\r\n                    }else {\r\n                        missType();\r\n                    }\r\n\r\n                }else {\r\n                    missType();\r\n                }\r\n            }else {\r\n                missType();\r\n            }\r\n            flagN = 0;\r\n        }\r\n\r\n        function collationList(judgeTyping, remainingList) {\r\n            //照合する打ち方を格納する変数\r\n            let returnAnotherList = [];\r\n            //remainingListの要素の数の分照合を行う\r\n            for(let i = 0; i < remainingList.length; i++) {\r\n\r\n                if(remainingList[i].startsWith(judgeTyping)) {\r\n                    returnAnotherList.push(remainingList[i]);\r\n                }\r\n            }\r\n\r\n            return returnAnotherList;\r\n        }\r\n\r\n        function correctType() {\r\n            //正解音と不正解音をリセットし、正解音を鳴らす\r\n            //document.getElementById('missaudio').pause();\r\n            $('#missAudio')[0].currentTime = 0;\r\n            //document.getElementById('correctaudio').pause();\r\n            $('#correctAudio')[0].currentTime = 0;\r\n            $('#correctAudio')[0].play();\r\n            //正解した文字の色を切り替える\r\n            $('#word_romaji').html(\"<span style='color: red;'>\" + $('#word_romaji').text().substr(0, charNum+1) + \"</span>\" + $('#word_romaji').text().substr(charNum + 1, $('#word_romaji').text().length));\r\n            //次の文字のセットと正解数のカウントアップ\r\n            charNum++;\r\n            correctCount++;\r\n\r\n            $('#monster_hp').text(parseInt($('#monster_hp').text()) - strike);\r\n            if($('#monster_hp').text() <= 0) {\r\n                $('#monster_hp').text(0);\r\n                victory();\r\n            }\r\n            charInsort();\r\n        }\r\n\r\n        function missType() {\r\n            //正解音と不正解音をリセットし、不正解音を鳴らす\r\n            //document.getElementById('missaudio').pause();\r\n            $('#missAudio')[0].currentTime = 0;\r\n            //document.getElementById('correctaudio').pause();\r\n            $('#correctAudio')[0].currentTime = 0;\r\n            $('#missAudio')[0].play();\r\n            //不正解数のカウントアップ\r\n            mistakeCount++;\r\n            finishRomaji = finishRomaji.slice(0, -1);\r\n            judgeTyping = judgeTyping.slice(0, -1);\r\n\r\n            $('#player_hp').text(parseInt($('#player_hp').text()) - mistakeDamage);\r\n            $('#battle_text').append(\"<br>タイプミス！\" + user.name + \"は \" + mistakeDamage + \" のダメージ！\");\r\n            if($('#player_hp').text() <= 0) {\r\n                $('#player_hp').text(0);\r\n                gameover();\r\n            }\r\n            textScroll();    \r\n        }\r\n\r\n        if(currentRomaji == \"\") {\r\n            currentRomaji = separationRomaji.shift();\r\n            currentStr = separationKana.shift();\r\n\r\n            if(judgeTyping == \"n\" && (fieldData.id != 2 || field.id != 4)) {\r\n                flagN = 1;\r\n            }else {\r\n                flagN = 0;\r\n            }\r\n\r\n            judgeTyping = \"\";\r\n        }\r\n\r\n        //次の問題の出題処理\r\n        if($('#monster_hp').text() != 0 && $('#player_hp').text() != 0 && charNum == $('#word_romaji').text().length){\r\n            charNum = 0;\r\n            judgeTyping = [];\r\n            finishRomaji = [];\r\n            setQuestion();\r\n        }\r\n    }\r\n\r\n    //モンスターの攻撃カウント処理\r\n    function monsterAttackCount(){\r\n        //timeRemaining変数にmonster.attack_intervalを代入する\r\n        timeRemaining = monster.attack_interval;\r\n\r\n        $('#count').html(\"モンスターの攻撃まであと <span class='time'>\" + timeRemaining + \"</span> 秒\");\r\n\r\n        clearInterval(attackTimer);\r\n        //モンスターの攻撃カウントダウン処理\r\n        attackTimer = setInterval(function(){\r\n            if(parseInt($('#player_hp').text()) <= 0 || parseInt($('#monster_hp').text()) <= 0){\r\n                return false;\r\n            }\r\n\r\n            if(status == 2) {\r\n                timeRemaining--;\r\n                $('#count').html(\"モンスターの攻撃まであと <span class='time'>\" + timeRemaining + \"</span> 秒\");\r\n                if(timeRemaining <= 0){\r\n                    clearInterval(attackTimer);\r\n                    //モンスター攻撃処理\r\n                    monsterAttack();\r\n                }\r\n            }\r\n        }, 1000);\r\n    }\r\n\r\n    //モンスターの攻撃処理\r\n    function monsterAttack() {\r\n        //player.hpの減少処理\r\n        $('#player_hp').html(parseInt($('#player_hp').text()) - damage);\r\n\r\n        $('#attackAudio')[0].play();\r\n\r\n        $('#battle_text').append(\"<br>\" + monster.name + \"の攻撃！主人公は \" + damage + \" のダメージ！\");\r\n\r\n        textScroll();\r\n\r\n        if($('#player_hp').text() <= 0){\r\n            $('#player_hp').text(0);\r\n            gameover();\r\n        }\r\n\r\n        monsterAttackCount();\r\n    }\r\n\r\n\r\n\r\n    //以下バトル勝利～勝利後の処理 status=3\r\n\r\n    //勝利処理\r\n    function victory(){\r\n        //モンスター攻撃カウントと問題文を非表示にする\r\n        $('#count').hide();\r\n        $('#word').hide();\r\n        $('#word_kana').hide();\r\n        $('#word_romaji').hide();\r\n        \r\n        //戦闘BGMを停止し、勝利BGMを流す\r\n        $('#battleAudio')[0].pause();\r\n        $('#battleAudio')[0].currentTime = 0;\r\n        $('#victoryAudio')[0].play();\r\n        $('#victoryAudio')[0].volume = 0.4;\r\n        $('.victoryVoice')[0].play();\r\n        $('#battle_text').append(\"<br>\" + monster.name + \"をたおした！\");\r\n        $('#monster_image').css('visibility', 'hidden');\r\n        textScroll();\r\n\r\n        //スコアを計算し表示\r\n        score = Math.ceil(monster.hp * (correctCount/(correctCount+mistakeCount)) - (mistakeCount * mistakeDamage));\r\n\r\n        //勝利カウントを増やす\r\n        switch(field.id) {\r\n            case 1:\r\n                player.field1_victory_count++;\r\n                nextFieldFlag1 = 1;\r\n                break;\r\n            case 2:\r\n                player.field2_victory_count++;\r\n                nextFieldFlag2 = 1;\r\n                break;\r\n            case 3:\r\n                player.field3_victory_count++;\r\n                nextFieldFlag3 = 1;\r\n                break;\r\n            case 4:\r\n                player.field4_victory_count++;\r\n                nextFieldFlag4 = 1;\r\n                break;\r\n            case 5:\r\n                player.field5_victory_count++;\r\n                break;\r\n        }\r\n\r\n        $('#scoredis').show();\r\n        $('#press_enter').show();\r\n        $('#scoredis').html(\"スコア： \" + score + \"点<hr>正タイプ数： \" + correctCount + \"<br>ミスタイプ数： \" + mistakeCount);\r\n\r\n        status = 3;\r\n    }\r\n\r\n    //経験値獲得処理\r\n    function addExp() {\r\n        $('#battle_text').append(\"<br>\" + user.name + \"は \" + monster.exp + \" の経験値を得た\");\r\n        textScroll();\r\n        //ドロップ判定\r\n        //ドロップアイテムを既に持っている場合はドロップしない\r\n        let havingItemsId = [];\r\n        for(let i = 0; i < havingItems.length; i++) {\r\n            havingItemsId.push(havingItems[i].id);\r\n        }\r\n        judgeHaving = $.inArray(dropItem.id, havingItemsId);\r\n\r\n        if(judgeHaving < 0) {\r\n            judgeDrop = parseInt(Math.random() * 5);\r\n        }else {\r\n            judgeDrop = 1;\r\n        }\r\n\r\n        if(judgeDrop == 0) {\r\n            player.get_item = dropItem.id;\r\n        }else {\r\n            player.get_item = \"\";\r\n        }\r\n\r\n        //レベルアップ判定とアイテムドロップ判定\r\n        if(player.next_exp <= monster.exp) {\r\n            displayEnter = 1;\r\n        }else if(judgeDrop == 0) {\r\n            player.next_exp -= monster.exp;\r\n            displayEnter = 4;\r\n        }else {\r\n            player.next_exp -= monster.exp;\r\n            displayEnter = 5;\r\n        }\r\n    }\r\n\r\n    //レベルアップ処理\r\n    function levelUp() {\r\n        let getExp = monster.exp;\r\n        player.exp += getExp;\r\n\r\n        for(let i = player.level; ; i++) {\r\n\r\n            if(getExp < player.next_exp) {\r\n                player.next_exp -= getExp;\r\n                player.level += levelUpCount;\r\n                bonusPoint = levelUpCount;\r\n                break;\r\n            }\r\n\r\n            getExp -= player.next_exp;\r\n            player.next_exp = nextExp(i);\r\n            levelUpCount++;\r\n        }\r\n\r\n        $('#battle_text').append(`<br>${user.name} は レベル <span style=\"color: yellow\">${player.level}</span> に上がった！`);\r\n        textScroll();\r\n\r\n        displayEnter = 2;\r\n    }\r\n\r\n    //レベルアップ時のHP成長とボーナスポイントを振り分ける処理\r\n    function addStatusSelect() {\r\n        let growHp = 0;\r\n        for(let i = 0; i < levelUpCount; i++) {\r\n            growHp += parseInt(Math.random() * 5 + 5);\r\n        }\r\n\r\n        player.hp += growHp;\r\n        $('#battle_text').append(`<br>さいだいHPが<span style=\"color: yellow\"> ${growHp} </span>上がった！`);\r\n        divideBonusPoint();\r\n\r\n        $('#press_enter').hide();\r\n        displayEnter = 3;\r\n        levelUpCount = 0;\r\n    }\r\n\r\n    //ボーナスポイント振り分け選択処理\r\n    function divideBonusPoint() {\r\n        if(bonusPoint == 0) {\r\n            $('#press_enter').show();\r\n\r\n            if(judgeDrop == 0) {\r\n                displayEnter = 4;\r\n            }else {\r\n                displayEnter = 5;\r\n            }\r\n        }else {\r\n            $('#battle_text').append(\"<br>成長させるステータスを選んでください  ボーナスポイント残り \"\r\n            + bonusPoint + \"<br>HP(\" + player.hp + \"→\" + (player.hp + 10) + \")：1ボタン　攻撃力(\" + player.attack + \"→\" + (player.attack + 1)\r\n            + \")：2ボタン　防御力(\" + player.defence + \"→\" + (player.defence + 2) + \")：3ボタン\");\r\n            textScroll();\r\n        }\r\n    }\r\n\r\n    //HP成長を選んだ際の処理\r\n    function addHp() {\r\n        player.hp += 10;\r\n        $('#battle_text').append(\"<br>さらに、さいだいHPが<span style='color: yellow'> 10 </span>上がった！\");\r\n        textScroll();\r\n        bonusPoint--;\r\n\r\n        divideBonusPoint();\r\n    }\r\n\r\n    //攻撃力成長を選んだ際の処理\r\n    function addAttack() {\r\n        player.attack++;\r\n        $('#battle_text').append(\"<br>さらに、攻撃力が<span style='color: yellow'> 1 </span>上がった！\");\r\n        textScroll();\r\n        bonusPoint--;\r\n\r\n        divideBonusPoint();\r\n    }\r\n\r\n    //防御力成長を選んだ際の処理\r\n    function addDefence() {\r\n        player.defence += 2;\r\n        $('#battle_text').append(\"<br>さらに、防御力が<span style='color: yellow'> 2 </span>上がった！\");\r\n        textScroll();\r\n        bonusPoint--;\r\n\r\n        divideBonusPoint();\r\n    }\r\n\r\n    //アイテム獲得処理\r\n    function itemDrop() {\r\n\r\n        $('#battle_text').append(\"<br><span style='color: lime'>\" + dropItem.name + \" </span>を手に入れた！\");\r\n        textScroll();\r\n\r\n        displayEnter = 5;\r\n    }\r\n\r\n    //勝利後のデータを保存する処理\r\n    function dataSave() {\r\n        $('#battle_text').append(\"<br>データを保存しています・・・\");\r\n        textScroll();\r\n\r\n        $.ajax({\r\n            url: '/setdata',\r\n            type: 'POST',\r\n            dataType: 'text',\r\n            contentType: \"application/json\",\r\n            data: JSON.stringify(\r\n                player,\r\n            ),\r\n        })\r\n        .done(function() {\r\n            $('#battle_text').append(\"<br>データを保存しました。\");\r\n            if(player.field1_victory_count == 5 && nextFieldFlag1 == 1) {\r\n                $('#battle_text').append(\"<br>新たなフィールド <span style='color: yellow'>森林地帯</span> が解放されました！\");\r\n                releaseField();\r\n            }else if(player.field2_victory_count == 5 && nextFieldFlag2 == 1) {\r\n                $('#battle_text').append(\"<br>新たなフィールド <span style='color: yellow'>荒野地帯</span> が解放されました！\");\r\n                releaseField();\r\n            }else if(player.field3_victory_count == 5 && nextFieldFlag3 == 1) {\r\n                $('#battle_text').append(\"<br>新たなフィールド <span style='color: yellow'>山岳地帯</span> が解放されました！\");\r\n                releaseField();\r\n            }else if(player.field4_victory_count == 5 && nextFieldFlag4 == 1) {\r\n                $('#battle_text').append(\"<br>新たなフィールド <span style='color: yellow'>魔界</span> が解放されました！\");\r\n                releaseField();\r\n            }\r\n            textScroll();\r\n            displayEnter = 0;\r\n            status = 4;\r\n            judgeEnter = 0;\r\n        })\r\n        .fail(function(response) {\r\n            console.log(response)\r\n            $('#battle_text').append(\"<br>データの保存に失敗しました。\");\r\n            textScroll();\r\n            judgeEnter = 0;\r\n        });\r\n\r\n    }\r\n    \r\n\r\n\r\n    //以下バトル敗北処理\r\n\r\n    //敗北処理\r\n    function gameover(){\r\n        //モンスター攻撃カウントと問題文を非表示にする\r\n        $('#count').hide();\r\n        $('#word').hide();\r\n        $('#word_kana').hide();\r\n        $('#word_romaji').hide();\r\n\r\n        //戦闘BGMを停止し、敗北BGMを流す\r\n        $('#battleAudio')[0].pause();\r\n        $('#battleAudio')[0].currentTime = 0;\r\n        $('#loseAudio')[0].play();\r\n        $('#loseAudio')[0].volume = 0.4;\r\n        $('.loseVoice')[0].play();\r\n\r\n        //敗北テキストの表示\r\n        $('#battle_text').append(\"<br>\" + monster.name + \"にやぶれた・・・\");\r\n\r\n        $('#press_enter').show();\r\n\r\n        //プレイヤー画像を非表示にする\r\n        $('#player_image').css('visibility', 'hidden');\r\n        textScroll();\r\n\r\n        player.get_item = \"\";\r\n        status = 4;\r\n    }\r\n\r\n\r\n\r\n    //以下バトル終了後の次の行動を選択する処理 status=4\r\n\r\n    //次の行動を選択する処理\r\n    function selectNextAction() {\r\n        $('#press_enter').hide();\r\n        $('#scoredis').hide();\r\n\r\n        $('#battle_text').append(\"<br>次の行動を選択してください。\");\r\n        textScroll();\r\n\r\n        $('.select_next_action').css('display', 'flex');\r\n\r\n        battleInit();\r\n    }\r\n\r\n    //次のバトルを選択した際の処理\r\n    $('#next_battle').on('click', function() {\r\n        $('.select_next_action').hide();\r\n        $('.select_field_display').hide();\r\n        $('.equipment_display').hide();\r\n        getData();\r\n    });\r\n\r\n    //フィールドの変更を選択した際の処理\r\n    $('#change_field').on('click', function() {\r\n        $('#change_field_btn').trigger('click');\r\n    })\r\n\r\n    //装備の変更ボタンを選択した際の処理\r\n    $('#change_equipment').on('click', function() {\r\n        $('#change_equipment_btn').trigger('click');\r\n    });\r\n\r\n\r\n\r\n    //以下システム処理やメインページの各ボタンを押した際の処理\r\n\r\n    //バトル中に使用した変数を初期化\r\n    function battleInit() {\r\n        //各変数の初期化\r\n        questions = [];\r\n        monster = [];\r\n        dropItem = [];\r\n        user = [];\r\n        field = [];\r\n        havingItems = [];\r\n        status = 0;\r\n        displayEnter = 0;\r\n        readyTime = 3;\r\n        words = [];\r\n        wordsKana = [];\r\n        separationKana = [];\r\n        separationRomaji = [];\r\n        aditionalDict = [];\r\n        correctCount = 0;\r\n        mistakeCount = 0;\r\n        score = 0;\r\n        judgeTyping = [];\r\n        finishRomaji = [];\r\n        flagN = 0;\r\n        levelUpCount = 0;\r\n        bonusPoint = 0;\r\n        currentChar = \"\";\r\n        charNum = 0;\r\n        timeRemaining = 0;\r\n        nextFieldFlag1 = 0;\r\n        nextFieldFlag2 = 0;\r\n        nextFieldFlag3 = 0;\r\n        nextFieldFlag4 = 0;\r\n        $('#change_equipment_btn').prop('disabled', false);\r\n        $('#change_equipment_btn').css('color', 'white');\r\n        $('#change_field_btn').prop('disabled', false);\r\n        $('#change_field_btn').css('color', 'white');\r\n    }\r\n\r\n    //statusの値によってキーボードを押した際の動作を分ける\r\n    $('body').on('keydown', function(e) {\r\n\r\n        //バトル開始前\r\n        if(status == 1 && e.key == ' ') {\r\n            if(infoFlag == 1) {\r\n                return false;\r\n            }\r\n            $('#battle_btn').trigger('click');\r\n        }\r\n\r\n        //バトル中\r\n        if(status == 2) {\r\n            if(infoFlag == 1) {\r\n                return false;\r\n            }\r\n\r\n            if(e.key == \"Escape\") {\r\n                $('#battle_reset').trigger('click');\r\n            }else {\r\n                typing(e.key);\r\n            }\r\n        }\r\n\r\n        //バトル勝利後\r\n        if(status == 3 && displayEnter == 3) {\r\n            if(infoFlag == 1) {\r\n                return false;\r\n            }\r\n\r\n            if(e.key == 1) {\r\n                addHp();\r\n            }else if(e.key == 2) {\r\n                addAttack();\r\n            }else if(e.key == 3) {\r\n                addDefence();\r\n            }else if(e.key == \"Enter\"){\r\n                return false;\r\n            }\r\n        }\r\n\r\n        if(status == 3 && e.key == \"Enter\") {\r\n            if(judgeEnter == 1 || infoFlag == 1) {\r\n                return false;\r\n            }\r\n\r\n            if(displayEnter == 0) {\r\n                addExp();\r\n            }else if(displayEnter == 1) {\r\n                levelUp();\r\n            }else if(displayEnter == 2) {\r\n                addStatusSelect();\r\n            }else if(displayEnter == 4) {\r\n                itemDrop();\r\n            }else {\r\n                judgeEnter = 1;\r\n                dataSave();\r\n            }\r\n        }\r\n\r\n        //バトル敗北または勝利後の経験値取得やレベルアップ処理後\r\n        if(status == 4 && e.key == \"Enter\") {\r\n            selectNextAction();\r\n        }\r\n    });\r\n\r\n\r\n    //所持アイテム一覧の取得と表示処理\r\n    function getHavingItem() {\r\n        $.ajax({\r\n            url: '/getitem',\r\n            type: 'POST',\r\n        })\r\n        .done(function(response) {\r\n            havingItems = response.items;\r\n            equipItem = response.equip_item;\r\n            let i;\r\n            let html = \"\";\r\n            \r\n            for(i = 0; i < havingItems.length; i++) {\r\n                html += `<li class=\"having_item\" data-id=\"${havingItems[i].id}\">\r\n                            <div class=\"item_image\">\r\n                                <img src=\"/images/item_images/${havingItems[i].image}\" alt=\"${havingItems[i].name}\">\r\n                                <p>${havingItems[i].name}</p>\r\n                            </div>\r\n                            <div class=\"item_detail\">\r\n                                <p><i class=\"far fa-hand-rock\"></i>：<span>${havingItems[i].attack}</span></p>\r\n                                <p><i class=\"fas fa-shield-alt\"></i>：<span>${havingItems[i].defence}</span></p>\r\n                                <p><i class=\"far fa-tired\"></i>：<span>${havingItems[i].mistake_damage}</span></p>\r\n                            </div>\r\n                        </li>`;\r\n            }\r\n\r\n            $('.having_items_list').empty().append(html);\r\n            setEquip();\r\n            \r\n            $('.equipment_display').show();\r\n            $('#battle_text').append(\"<br>装備するアイテムを選択してください。\");\r\n        })\r\n        .fail(function(response) {\r\n            console.log(response)\r\n            $('#battle_text').append(\"<br>データの取得に失敗しました。\");\r\n            textScroll();\r\n        });\r\n    }\r\n\r\n    //装備中のアイテムをオレンジの枠で囲む処理\r\n    function setEquip() {\r\n        $('.equip').removeClass('equip');\r\n\r\n        if(equipItem != null) {\r\n            $('.having_item').filter(function() {\r\n                return($(this).data('id') == equipItem.id);\r\n            })\r\n            .addClass('equip');\r\n        }\r\n    }\r\n\r\n    //所持アイテムの装備着脱処理\r\n    $(document).on('click', '.having_item', function() {\r\n        let itemId = {'id': $(this).data('id')}\r\n\r\n        if(equipItem != null && equipItem.id == itemId.id) {\r\n            itemId = {'id': ''};\r\n        }else {\r\n            itemId = {'id': $(this).data('id')};\r\n        }\r\n\r\n        $.ajax({\r\n            url: '/setitem',\r\n            type: 'POST',\r\n            contentType: \"application/json\",\r\n            data: JSON.stringify(\r\n                itemId,\r\n            ),\r\n        })\r\n        .done(function(response) {\r\n            //equipItemの書き換え\r\n            equipItem = response.item;\r\n            //プレイヤーステータスの書き換え\r\n            setPlayerStatus();\r\n\r\n            if(equipItem != null) {\r\n                $('#battle_text').append(\"<br>\" + equipItem.name + \" を装備しました。\");\r\n            }else {\r\n                $('#battle_text').append(\"<br>装備を外しました。\");\r\n            }\r\n\r\n            setEquip();\r\n            textScroll();\r\n        })\r\n        .fail(function(response) {\r\n            console.log(response);\r\n            $('#battle_text').append(\"<br>通信に失敗しました。\");\r\n            textScroll();\r\n        });\r\n    });\r\n\r\n    //装備選択画面を閉じる\r\n    $('.close_equipment').on('click', function() {\r\n        $('.equipment_display').hide();\r\n    });\r\n\r\n    $('#change_equipment_btn').on('click', function() {\r\n        $('#battle_text').append(\"<br>所持アイテムを取得中・・・\");\r\n        textScroll();\r\n\r\n        getHavingItem();\r\n    });\r\n\r\n    //ヘッダーのフィールド変更ボタンを押した際の処理\r\n    $('#change_field_btn').on('click', function() {\r\n        $('.select_next_action').hide();\r\n        $('.equipment_display').hide();\r\n        $('#battle_btn').hide();\r\n        $('.select_field_display').show();\r\n        fieldData = new FormData();\r\n\r\n        $('#battle_text').html(\"フィールドを選択してください。\");\r\n        status = 0;\r\n    });\r\n\r\n    //ヘッダーのバトルのリセットボタンを押した際の処理\r\n    $('#battle_reset').on('click', function() {\r\n        if(status != 2) {\r\n            return false;\r\n        }\r\n        clearInterval(attackTimer);\r\n        $('#change_equipment_btn').prop('disabled', false);\r\n        $('#change_equipment_btn').css('color', 'white');\r\n        $('#change_field_btn').prop('disabled', false);\r\n        $('#change_field_btn').css('color', 'white');\r\n        $('#count').hide();\r\n        $('#word').hide();\r\n        $('#word_kana').hide();\r\n        $('#word_romaji').hide();\r\n        $('#battleAudio')[0].pause();\r\n        $('#battleAudio')[0].currentTime = 0;\r\n        $('#player_hp').text(player.hp);\r\n        $('#monster_hp').text(monster.hp);\r\n        $('#battle_text').html(\"バトルをリセットしました。<br>BATTLE STARTボタンをクリック または スペースキーを押して戦闘開始\");\r\n        $('#battle_btn').show();\r\n        correctCount = 0;\r\n        mistakeCount = 0;\r\n        currentChar = \"\";\r\n        charNum = 0;\r\n        judgeTyping = [];\r\n        finishRomaji = [];\r\n        timeRemaining = 0;\r\n\r\n        status = 1;\r\n    });\r\n\r\n    //インフォメーションボタンを押した際の処理\r\n    $('#show_info').on('click', function() {\r\n        $('#game_tab').prop('checked', true);\r\n        infoFlag = 1;\r\n        //インフォメーションモーダルを開く\r\n        $('.info_modal').show();\r\n    })\r\n\r\n    //インフォメーションモーダルを閉じる処理\r\n    $('.modal_close').on('click', function() {\r\n        infoFlag = 0;\r\n        $('.info_modal').hide();\r\n    })\r\n\r\n    //新たなフィールドを解放する処理\r\n    function releaseField() {\r\n        if(player.field1_victory_count >= 5) {\r\n            $('#field2').removeClass('not_select');\r\n            $('#field2').prop('disabled', false);\r\n        }\r\n        if(player.field2_victory_count >= 5) {\r\n            $('#field3').removeClass('not_select');\r\n            $('#field3').prop('disabled', false);\r\n        }\r\n        if(player.field3_victory_count >= 5) {\r\n            $('#field4').removeClass('not_select');\r\n            $('#field4').prop('disabled', false);\r\n        }\r\n        if(player.field4_victory_count >= 5) {\r\n            $('#field5').removeClass('not_select');\r\n            $('#field5').prop('disabled', false);\r\n        }\r\n    }\r\n\r\n    //選択したフィールドでの勝利数を返す\r\n    function victoryCount() {\r\n        switch(field.id) {\r\n            case 1:\r\n                return player.field1_victory_count;\r\n            case 2:\r\n                return player.field2_victory_count;\r\n            case 3:\r\n                return player.field3_victory_count;\r\n            case 4:\r\n                return player.field4_victory_count;\r\n            case 5:\r\n                return player.field5_victory_count;\r\n        }\r\n    }\r\n\r\n    //経験値テーブルの計算処理\r\n    function nextExp(currentLv) {\r\n        let returnExp = 0;\r\n        if(currentLv >= 40) {\r\n            returnExp = (currentLv - 40) * 10 + 160;\r\n        }else if(currentLv < 40 && currentLv >= 20) {\r\n            returnExp = (currentLv - 20) * 5 + 60;\r\n        }else {\r\n            returnExp = (currentLv + 1) * 3;\r\n        }\r\n\r\n        return returnExp;\r\n    }\r\n\r\n    //テキストを最下部へ自動スクロールする処理\r\n    function textScroll(){\r\n        battle_text.scroll(0, battle_text.scrollHeight);\r\n    }\r\n});\r\n"],"sourceRoot":""}