{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./resources/assets/js/main.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","kanaDict","$","ajaxSetup","headers","attr","dataType","processData","contentType","timeout","currentStr","currentRomaji","currentChar","score","strike","damage","mistakeDamage","judgeDrop","judgeHaving","timeRemaining","attackTimer","questions","player","monster","dropItem","user","field","havingItems","equipItem","victoryCnt","nextFieldFlag1","nextFieldFlag2","nextFieldFlag3","nextFieldFlag4","fieldData","FormData","status","displayEnter","readyTime","words","wordsKana","separationKana","separationRomaji","aditionalDict","charNum","correctCount","mistakeCount","judgeTyping","finishRomaji","flagN","levelUpCount","bonusPoint","judgeEnter","infoFlag","getData","ajax","url","type","data","done","response","number","having_items","equip_item","hide","text","level","hp","victoryCount","parseInt","Math","random","monsters","dropItems","setPlayerStatus","player_image","image","css","html","show","fail","console","log","append","textScroll","attack","defence","min_attack","mistake_damage","setQuestion","length","id","returnRomaji","returnAditionalDict","judgeN","aditionalList","push","indexOf","strList","j","wordChangeRomaji","kana","returnKana","judgeChar","beforeKana","pop","wordSeparation","join","shift","charInsort","charAt","typing","keyStr","collationList","remainingList","returnAnotherList","startsWith","correctType","currentTime","play","substr","pause","volume","ceil","field1_victory_count","field2_victory_count","field3_victory_count","field4_victory_count","field5_victory_count","victory","missType","slice","gameover","anotherList","nextStr","unshift","nextRomaji","monsterAttackCount","attack_interval","clearInterval","setInterval","monsterAttack","divideBonusPoint","get_item","selectNextAction","prop","setEquip","removeClass","filter","this","addClass","releaseField","nextExp","currentLv","battle_text","scroll","scrollHeight","on","e","preventDefault","val","word","word_kana","readyTimer","loop","ready","trigger","exp","havingItemsId","inArray","next_exp","addExp","getExp","levelUp","growHp","addStatusSelect","JSON","stringify","document","itemId","item","items","empty"],"mappings":"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","file":"/js/main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 41);\n","//かな辞書 kanaDictionary\r\nconst kanaDict = {\r\n    \"あ\":[\"a\"], \"い\":[\"i\",\"yi\"], \"う\":[\"u\",\"wu\",\"whu\"], \"え\":[\"e\"], \"お\":[\"o\"],\r\n    \"か\":[\"ka\",\"ca\"], \"き\":[\"ki\"], \"く\":[\"ku\",\"cu\",\"qu\"], \"け\":[\"ke\"], \"こ\":[\"ko\",\"co\"],\r\n    \"さ\":[\"sa\"],\"し\":[\"si\",\"ci\",\"shi\"],\"す\":[\"su\"],\"せ\":[\"se\",\"ce\"],\"そ\":[\"so\"],\r\n    \"た\":[\"ta\"],\"ち\":[\"ti\",\"chi\"],\"つ\":[\"tu\",\"tsu\"],\"て\":[\"te\"],\"と\":[\"to\"],\r\n    \"な\":[\"na\"],\"に\":[\"ni\"],\"ぬ\":[\"nu\"],\"ね\":[\"ne\"],\"の\":[\"no\"],\r\n    \"は\":[\"ha\"],\"ひ\":[\"hi\"],\"ふ\":[\"hu\",\"fu\"],\"へ\":[\"he\"],\"ほ\":[\"ho\"],\r\n    \"ま\":[\"ma\"],\"み\":[\"mi\"],\"む\":[\"mu\"],\"め\":[\"me\"],\"も\":[\"mo\"],\r\n    \"や\":[\"ya\"],\"ゆ\":[\"yu\"],\"よ\":[\"yo\"],\r\n    \"ら\":[\"ra\"],\"り\":[\"ri\"],\"る\":[\"ru\"],\"れ\":[\"re\"],\"ろ\":[\"ro\"],\r\n    \"わ\":[\"wa\"],\"を\":[\"wo\"],\"ん\":[\"n\",\"nn\",\"xn\"],\r\n    \"が\":[\"ga\"],\"ぎ\":[\"gi\"],\"ぐ\":[\"gu\"],\"げ\":[\"ge\"],\"ご\":[\"go\"],\r\n    \"ざ\":[\"za\"],\"じ\":[\"zi\",\"ji\"],\"ず\":[\"zu\"],\"ぜ\":[\"ze\"],\"ぞ\":[\"zo\"],\r\n    \"だ\":[\"da\"],\"ぢ\":[\"di\"],\"づ\":[\"du\"],\"で\":[\"de\"],\"ど\":[\"do\"],\r\n    \"ば\":[\"ba\"],\"び\":[\"bi\"],\"ぶ\":[\"bu\"],\"べ\":[\"be\"],\"ぼ\":[\"bo\"],\r\n    \"ぱ\":[\"pa\"],\"ぴ\":[\"pi\"],\"ぷ\":[\"pu\"],\"ぺ\":[\"pe\"],\"ぽ\":[\"po\"],\r\n    \"きゃ\":[\"kya\",\"kilya\",\"kixya\"],\"きぃ\":[\"kyi\",\"kili\",\"kixi\",\"kilyi\",\"kixyi\"],\"きゅ\":[\"kyu\",\"kilyu\",\"kixyu\"],\"きぇ\":[\"kye\",\"kile\",\"kixe\",\"kilye\",\"kixye\"],\"きょ\":[\"kyo\",\"kilyo\",\"kixyo\"],\r\n    \"ぎゃ\":[\"gya\",\"gilya\",\"gixya\"],\"ぎぃ\":[\"gyi\",\"gili\",\"gixi\",\"gilyi\",\"gixyi\"],\"ぎゅ\":[\"gyu\",\"gilyu\",\"gixyu\"],\"ぎぇ\":[\"gye\",\"gile\",\"gixe\",\"gilye\",\"gixye\"],\"ぎょ\":[\"gyo\",\"gilyo\",\"gixyo\"],\r\n    \"しゃ\":[\"sya\",\"sha\",\"sixya\",\"silya\",\"shixya\",\"shilya\",\"cixya\",\"cilya\"],\"しぃ\":[\"syi\",\"sili\",\"sixi\",\"silyi\",\"sixyi\",\"shixi\",\"shili\",\"cixi\",\"cili\"],\"しゅ\":[\"syu\",\"shu\",\"silyu\",\"sixyu\",\"shixyu\",\"shilyu\",\"cixyu\",\"cilyu\"],\"しぇ\":[\"she\",\"sye\",\"sile\",\"sixe\",\"silye\",\"sixye\",\"shixe\",\"shile\",\"cixe\",\"cile\"],\"しょ\":[\"syo\",\"sho\",\"silyo\",\"sixyo\",\"shixyo\",\"shilyo\",\"cixyo\",\"cilyo\"],\r\n    \"じゃ\":[\"ja\",\"zya\",\"jya\",\"zilya\",\"zixya\",\"jilya\",\"jixya\"],\"じぃ\":[\"zyi\",\"jyi\",\"zili\",\"zixi\",\"jili\",\"jixi\",\"zilyi\",\"zixyi\",\"jilyi\",\"jixyi\"],\"じゅ\":[\"zyu\",\"ju\",\"jyu\",\"zixyu\",\"zilyu\",\"jixyu\",\"jilyu\"],\"じぇ\":[\"zye\",\"je\",\"jye\",\"zixe\",\"zile\",\"jixe\",\"jile\"],\"じょ\":[\"zyo\",\"jo\",\"jyo\",\"zixyo\",\"zilyo\",\"jixyo\",\"jilyo\"],\r\n    \"ちゃ\":[\"tya\",\"cha\",\"cya\",\"tixya\",\"tilya\",\"chixya\",\"chilya\"],\"ちぃ\":[\"tyi\",\"cyi\",\"tixi\",\"tili\",\"chixi\",\"chili\"],\"ちゅ\":[\"tyu\",\"chu\",\"cyu\",\"tixyu\",\"tilyu\",\"chixyu\",\"chilyu\"],\"ちぇ\":[\"tye\",\"che\",\"cye\",\"tixe\",\"tile\",\"chixe\",\"chile\"],\"ちょ\":[\"tyo\",\"cho\",\"cyo\",\"tixyo\",\"tilyo\",\"chixyo\",\"chilyo\"],\r\n    \"にゃ\":[\"nya\",\"nixya\",\"nilya\"],\"にぃ\":[\"nyi\",\"nixi\",\"nili\"],\"にゅ\":[\"nyu\",\"nixyu\",\"nilyu\"],\"にぇ\":[\"nye\",\"nixe\",\"nile\"],\"にょ\":[\"nyo\",\"nixyo\",\"nilyo\"],\r\n    \"ひゃ\":[\"hya\",\"hixya\",\"hilya\"],\"ひぃ\":[\"hyi\",\"hixi\",\"hili\"],\"ひゅ\":[\"hyu\",\"hixyu\",\"hilyu\"],\"ひぇ\":[\"hye\",\"hixe\",\"hile\"],\"ひょ\":[\"hyo\",\"hixyo\",\"hilyo\"],\r\n    \"ふぁ\":[\"fa\",\"fwa\",\"fuxa\",\"fula\",\"huxa\",\"hula\"],\"ふぃ\":[\"fi\",\"fwi\",\"fyi\",\"fuxi\",\"fuli\",\"huxi\",\"huli\"],\"ふぅ\":[\"fwu\",\"fuxu\",\"fulu\",\"huxu\",\"hulu\"],\"ふぇ\":[\"fe\",\"fwe\",\"fye\",\"fuxe\",\"fule\",\"huxe\",\"hule\"],\"ふぉ\":[\"fo\",\"fwo\",\"fuxo\",\"fulo\",\"huxo\",\"hulo\"],\r\n    \"くぁ\":[\"qwa\",\"qa\",\"kwa\",\"kuxa\",\"kula\",\"quxa\",\"qula\",\"cuxa\",\"cula\"],\"くぃ\":[\"qwi\",\"qi\",\"qyi\",\"kuxi\",\"kuli\",\"quxi\",\"quli\",\"cuxi\",\"culi\"],\"くぅ\":[\"qwu\",\"kuxu\",\"kulu\",\"quxu\",\"qulu\",\"cuxu\",\"culu\"],\"くぇ\":[\"qwe\",\"qe\",\"qye\",\"kuxe\",\"kule\",\"quxe\",\"qule\",\"cuxe\",\"cule\"],\"くぉ\":[\"qwo\",\"qo\",\"kuxo\",\"kulo\",\"quxo\",\"qulo\",\"cuxo\",\"culo\"],\r\n    \"ぐぁ\":[\"gya\",\"guxa\",\"gula\"],\"ぐぃ\":[\"gyi\",\"guxi\",\"guli\"],\"ぐぅ\":[\"gyu\",\"guxu\",\"gulu\"],\"ぐぇ\":[\"gye\",\"guxe\",\"gule\"],\"ぐぉ\":[\"gyo\",\"guxo\",\"gulo\"],\r\n    \"すぁ\":[\"swa\",\"suxa\",\"sula\"],\"すぃ\":[\"swi\",\"suxi\",\"suli\"],\"すぅ\":[\"swu\",\"suxu\",\"sulu\"],\"すぇ\":[\"swe\",\"suxe\",\"sule\"],\"すぉ\":[\"swo\",\"suxo\",\"sulo\"],\r\n    \"てゃ\":[\"tha\",\"texya\",\"telya\"],\"てぃ\":[\"thi\",\"texi\",\"teli\"],\"てゅ\":[\"thu\",\"texyu\",\"telyu\"],\"てぇ\":[\"the\",\"texe\",\"tele\"],\"てょ\":[\"tho\",\"texyo\",\"telyo\"],\r\n    \"とぁ\":[\"twa\"],\"とぃ\":[\"twi\"],\"とぅ\":[\"twu\",\"toxu\",\"tolu\"],\"とぇ\":[\"twe\"],\"とぉ\":[\"two\",\"toxo\",\"tolo\"],\r\n    \"ぢゃ\":[\"dya\",\"dixya\",\"dilya\"],\"ぢぃ\":[\"dyi\"],\"ぢゅ\":[\"dyu\"],\"ぢぇ\":[\"dye\"],\"ぢょ\":[\"dyo\"],\r\n    \"でゃ\":[\"dha\"],\"でぃ\":[\"dhi\",\"dexi\",\"deli\"],\"でゅ\":[\"dhu\",\"dexyu\",\"delyu\"],\"でぇ\":[\"dhe\"],\"でょ\":[\"dho\"],\r\n    \"どぁ\":[\"dwa\"],\"どぃ\":[\"dwi\"],\"どぅ\":[\"dwu\",\"doxu\",\"dolu\"],\"どぇ\":[\"dwe\"],\"どぉ\":[\"dwo\"],\r\n    \"びゃ\":[\"bya\",\"bixya\",\"bilya\"],\"びぃ\":[\"byi\"],\"びゅ\":[\"byu\",\"bixyu\",\"bilyu\"],\"びぇ\":[\"bye\"],\"びょ\":[\"byo\",\"bixyo\",\"bilyo\"],\r\n    \"ぴゃ\":[\"pya\",\"pixya\",\"pilya\"],\"ぴぃ\":[\"pyi\"],\"ぴゅ\":[\"pyu\",\"pixyu\",\"pilyu\"],\"ぴぇ\":[\"pye\"],\"ぴょ\":[\"pyo\",\"pixyo\",\"pilyo\"],\r\n    \"りゃ\":[\"rya\",\"rixya\",\"rilya\"],\"りゅ\":[\"ryu\",\"rixyu\",\"rilyu\"],\"りょ\":[\"ryo\",\"rixyo\",\"rilyo\"],\r\n    \"ー\":[\"-\"],\" \":[\" \"],\"、\":[\",\"],\"？\":[\"?\"],\"！\":[\"!\"],\"。\":[\".\"],\r\n    \"っ\":[\"xtu\",\"ltu\",\"xtsu\",\"ltsu\"],\r\n    \"ぁ\":[\"xa\",\"la\"],\r\n    \"ぇ\":[\"xe\",\"le\"],\r\n    \"ゃ\":[\"lya\",\"xya\"],\"ゅ\":[\"xyu\",\"lyu\"],\"ょ\":[\"lyo\",\"xyo\"],\r\n    \"a\":\"a\",\"b\":\"b\",\"c\":\"c\",\"d\":\"d\",\"e\":\"e\",\"f\":\"f\",\"g\":\"g\",\"h\":\"h\",\"i\":\"i\",\"j\":\"j\",\"k\":\"k\",\"l\":\"l\",\"m\":\"m\",\"n\":\"n\",\r\n    \"o\":\"o\",\"p\":\"p\",\"q\":\"q\",\"r\":\"r\",\"s\":\"s\",\"t\":\"t\",\"u\":\"u\",\"v\":\"v\",\"w\":\"w\",\"x\":\"x\",\"y\":\"y\",\"z\":\"z\",\r\n    \"\":\"\",\",\":\",\"\r\n}\r\n\r\n$(function() {\r\n\r\n    //ajax通信のセットアップ\r\n    $.ajaxSetup({\r\n        headers: {\r\n            'X-CSRF-TOKEN' : $('meta[name=\"csrf-token\"]').attr('content')\r\n        },\r\n        dataType: 'json',\r\n        processData: false,\r\n        contentType: false,\r\n        timeout: 10000,\r\n    });\r\n\r\n    //各取得データを保持する為の変数\r\n    let questions = [];\r\n    let player = [];\r\n    let monster = [];\r\n    let dropItem = [];\r\n    let user = [];\r\n    let field = [];\r\n    let havingItems = [];\r\n    let equipItem = [];\r\n    //勝利数を保持する変数\r\n    let victoryCnt = 0;\r\n    //フィールド解放フラグ\r\n    let nextFieldFlag1 = 0;\r\n    let nextFieldFlag2 = 0;\r\n    let nextFieldFlag3 = 0;\r\n    let nextFieldFlag4 = 0;\r\n    //選択したフィールドの値を保持しておく変数\r\n    let fieldData = new FormData();\r\n    //現在の画面ステータスを管理する\r\n    //0:フィールド選択中, 1:バトル開始前, 2:バトル中, 3:バトル勝利, 4:バトル敗北,またはバトル後の選択画面\r\n    let status = 0;\r\n    //勝利後のテキストスクロールに利用\r\n    let displayEnter = 0;\r\n    //バトル開始前のカウントダウン用\r\n    let readyTime = 3;\r\n    //questionsの各値を格納しておく変数\r\n    let words = [];\r\n    let wordsKana = [];\r\n    //問題文を区切って格納する為の変数\r\n    let separationKana = [];\r\n    let separationRomaji = [];\r\n    //あいまい入力用の一時的な辞書として利用する為の変数\r\n    let aditionalDict = [];\r\n    //入力対象を格納する為の変数\r\n    let currentStr,currentRomaji,currentChar;\r\n    //入力対象を判定する為の変数\r\n    let charNum = 0;\r\n    //正解数とミス数をカウントする変数\r\n    let correctCount = 0;\r\n    let mistakeCount = 0;\r\n    //スコア\r\n    let score;\r\n    //playerが与えるダメージ\r\n    let strike;\r\n    //playerが受けるダメージ\r\n    let damage;\r\n    //タイプミス時のダメージ\r\n    let mistakeDamage;\r\n    //\r\n    let judgeTyping = [];\r\n    let finishRomaji = [];\r\n    //\r\n    let flagN = 0;\r\n    //レベルアップ判定に利用\r\n    let levelUpCount = 0;\r\n    let bonusPoint = 0;\r\n    //アイテムドロップの判定に利用\r\n    let judgeDrop;\r\n    let judgeHaving;\r\n    let timeRemaining;\r\n    let attackTimer;\r\n    //バトル後のテキスト処理時にEnterキーが連打されるのを防ぐ為の変数\r\n    let judgeEnter = 0;\r\n    let infoFlag = 0;\r\n\r\n\r\n\r\n    //以下フィールド選択～バトル開始前の処理 status=0\r\n\r\n    //フィールドを選択した際の処理\r\n    $('.field_btn').on('click', function(e) {\r\n        e.preventDefault();\r\n\r\n\r\n        $('#battle_text').append(\"<br>\" + \"通信中・・・\")\r\n\r\n        fieldData.append('field_id', $(this).val());\r\n\r\n        getData();\r\n    });\r\n\r\n    //バトルを開始するのに必要なデータを取得する\r\n    function getData() {\r\n        $.ajax({\r\n            url: '/getdata',\r\n            type: 'POST',\r\n            data: fieldData,\r\n        })\r\n        .done(function(response) {\r\n            //各値を保持する\r\n            questions = response.questions;\r\n            player = response.player;\r\n            user = response.user;\r\n            field = response.field;\r\n            havingItems = response.having_items;\r\n            equipItem = response.equip_item;\r\n\r\n            //次のバトルを選択した際表示されていたボタンを非表示にする\r\n            $('.select_next_action').hide();\r\n            $('.select_field_display').hide();\r\n            $('.equipment_display').hide();    \r\n\r\n            //各値のセット\r\n            $('.player_name').text(user.name);\r\n            $('.player_level').text(player.level);\r\n            $('#player_hp').text(player.hp);\r\n            \r\n            let number;\r\n            victoryCnt = victoryCount();\r\n            if(victoryCnt < 5) {\r\n                number = parseInt(Math.random() * victoryCnt);\r\n            }else {\r\n                number = parseInt(Math.random() * 5);\r\n            }\r\n            \r\n            monster = response.monsters[number];\r\n            dropItem = response.dropItems[number];\r\n\r\n            $('.monster_name').text(monster.name);\r\n            $('#monster_hp').text(monster.hp);\r\n\r\n            //プレイヤーのステータス設定処理\r\n            setPlayerStatus();\r\n            \r\n            if(player.player_image == 1) {\r\n                $('.player_image').attr('src', '/images/player_images/主人公男h150.png');\r\n            }else {\r\n                $('.player_image').attr('src', '/images/player_images/主人公女h150.png');\r\n            }\r\n\r\n            $('.monster_image').attr('src', '/images/monster_images/' + monster.image);\r\n\r\n            $('.rpg_display').css('background-image', 'url(/images/field_images/' + field.image + ')');\r\n\r\n            $('.select_field_display').hide();\r\n            $('#battle_text').html(monster.name + 'があらわれた！' + \"<br>\" + 'BATTLE STARTボタンをクリック または スペースキーを押して戦闘開始' + \"<br>\" + '※ サウンドが流れます');\r\n            $('#battle_btn').show();\r\n            $('#monster_image').css('visibility', 'visible');\r\n            $('#player_image').css('visibility', 'visible');\r\n\r\n            status = 1;\r\n        })\r\n        .fail(function(response) {\r\n            console.log(response);\r\n            $('#battle_text').append(\"<br>通信に失敗しました。再度通信を行う場合はEnterキーを押してください。\");\r\n            textScroll();\r\n        })\r\n    }\r\n\r\n    //装備アイテムの有無により各ステータスを設定\r\n    function setPlayerStatus() {\r\n\r\n        if(equipItem == null) {\r\n            $('.attack').text(player.attack);\r\n            $('.item_attack').text(0);\r\n            $('.defence').text(player.defence);\r\n            $('.item_defence').text(0);\r\n            $('.mistake_damage').text(1);\r\n            $('.equipment_image').attr('src', '');\r\n\r\n            if((monster.attack - monster.min_attack) < player.defence) {\r\n                damage = monster.min_attack;\r\n            }else {\r\n                damage = monster.attack - player.defence;\r\n            }\r\n            strike = player.attack;\r\n            mistakeDamage = 1;\r\n        }else {\r\n            $('.attack').text(player.attack + equipItem.attack);\r\n            $('.item_attack').text(equipItem.attack);\r\n            $('.defence').text(player.defence + equipItem.defence);\r\n            $('.item_defence').text(equipItem.defence);\r\n            $('.mistake_damage').text(equipItem.mistake_damage);\r\n            $('.equipment_image').attr('src', '/images/item_images/'+equipItem.image);\r\n\r\n            if((monster.attack - monster.min_attack) < (player.defence + equipItem.defence)) {\r\n                damage = monster.min_attack;\r\n            }else {\r\n                damage = monster.attack - (player.defence + equipItem.defence);\r\n            }\r\n            strike = player.attack + equipItem.attack;\r\n            mistakeDamage = equipItem.mistake_damage;\r\n        }\r\n    }\r\n\r\n\r\n\r\n    //以下バトル開始前の処理 status=1\r\n\r\n    //BATTLE STARTボタンを押した際の処理\r\n    $('#battle_btn').on('click', function() {\r\n        $('#battle_btn').hide();\r\n        $('.select_field_display').hide();\r\n        $('.equipment_display').hide();\r\n        $('#selectAudio')[0].play();\r\n        ready();\r\n    });\r\n\r\n    //バトル準備\r\n    function ready() {\r\n        readyTime = 3;\r\n        //問題の出題準備\r\n        for(let i = 0; i < questions.length; i++) {\r\n            words.push(questions[i].word);\r\n            wordsKana.push(questions[i].word_kana);\r\n        }\r\n\r\n        $('#ready_count').show();\r\n        $('#ready_count').text(readyTime);\r\n        //ゲーム開始カウントダウン\r\n        let readyTimer = setInterval(function(){\r\n            $('#ready_count').text(readyTime);\r\n            readyTime--;\r\n            if(readyTime < 0){\r\n                clearInterval(readyTimer);\r\n                readyTime = 3;\r\n                $('#change_equipment_btn').prop('disabled', true);\r\n                $('#change_equipment_btn').css('color', 'lightgray');\r\n                $('#change_field_btn').prop('disabled', true);\r\n                $('#change_field_btn').css('color', 'lightgray');\r\n                gameStart();\r\n            }\r\n        }, 1000);\r\n    }\r\n\r\n    //バトル開始\r\n    function gameStart() {\r\n        $('#ready_count').hide();\r\n        //出題処理\r\n        setQuestion();\r\n        //各値の初期化\r\n        score = 0;\r\n        correctCount = 0;\r\n        mistakeCount = 0;\r\n        //サウンドの再生\r\n        $('#battleAudio')[0].play();\r\n        $('#battleAudio')[0].volume = 0.4;\r\n        $('#battleAudio')[0].loop = true;\r\n        $('.readyVoice')[0].play();\r\n        //monsterの攻撃カウントを開始する\r\n        $('#count').show();\r\n        monsterAttackCount();\r\n        status = 2;\r\n    }\r\n\r\n\r\n\r\n    //以下バトル中の処理 status=2\r\n\r\n    //出題処理\r\n    function setQuestion() {\r\n        //ランダムに出題を行う\r\n        let number = parseInt( Math.random() * words.length );\r\n        $('#word').show();\r\n        $('#word').text(words[number]);\r\n        if(field.id == 2 || field.id == 4) {\r\n            $('#word_kana').text('');            \r\n        }else {\r\n            $('#word_kana').text(wordsKana[number]);\r\n        }\r\n        $('#word_kana').show();\r\n        //ひらがな文字列を分割する\r\n        separationKana = wordSeparation(wordsKana[number]);\r\n        //分割したひらがな文字列をローマ字文字列に変換したものと、例外入力用の追加辞書を作成\r\n        [separationRomaji, aditionalDict] = wordChangeRomaji(separationKana);\r\n\r\n        $('#word_romaji').show();\r\n        $('#word_romaji').text(separationRomaji.join(''));\r\n        //分割済みの問題文の先頭1要素を取り出す\r\n        currentStr = separationKana.shift();\r\n        currentRomaji = separationRomaji.shift();\r\n\r\n        charInsort();\r\n    }\r\n\r\n    //問題文を分割する処理\r\n    function wordSeparation(kana) {\r\n        //returnする文字列を格納する変数\r\n        let returnKana = [];\r\n        //\"っ\"の判定に利用\r\n        let judgeChar = [\"a\", \"i\", \"u\", \"e\", \"o\", \"n\"];\r\n\r\n        //受け取った問題文の文字列を1文字づつ判定\r\n        for(let i = 0; i < kana.length; i++) {\r\n            //小文字の処理\r\n            //先頭文字でなく、1つ前の文字と今回の文字を繋げた文字列がkanaDictにある場合(\"しゃ\"など)\r\n            if(i > 0 && kanaDict[kana[i-1] + kana[i]]) {\r\n                //返す文字列に入れていた最後の要素を取り出す\r\n                let beforeKana = returnKana.pop();\r\n                //最後の要素に今回の文字を連結して1つのブロックとして再度挿入\r\n                returnKana.push(beforeKana + kana[i]);\r\n\r\n            //\"っ\"の処理\r\n            //最後の文字でなく、判定中の文字が\"っ\"であり、次の文字があ行またはな行ではない場合\r\n            }else if(i != kana.length - 1 && kana[i] == \"っ\" && judgeChar.indexOf(kanaDict[kana[i+1]][0][0]) == -1) {\r\n                //次の文字を連結して1つのブロックとして挿入\r\n                returnKana.push(kana[i] + kana[i+1]);\r\n                //次の文字の判定を飛ばす\r\n                i++;\r\n\r\n            //それ以外の通常判定\r\n            }else {\r\n                returnKana.push(kana[i]);\r\n            }\r\n        }\r\n        return returnKana;\r\n    }\r\n\r\n    //分割した問題文をローマ字表記に変換する処理\r\n    function wordChangeRomaji(separationKana) {\r\n        //returnするローマ字文字列\r\n        let returnRomaji = [];\r\n        //returnする例外入力用辞書\r\n        let returnAditionalDict = [];\r\n        //\"ん\"をnnまたはxnと入力しなければならない際の判定に利用\r\n        let judgeN = [\"a\", \"i\", \"u\", \"e\", \"o\", \"y\", \"n\"];\r\n        //あいまい入力の一時的なリスト\r\n        let aditionalList = [];\r\n\r\n        //分割されたブロック毎に判定を行う\r\n        for(let i = 0; i < separationKana.length; i++) {\r\n\r\n            //\"ん\"以外のブロック単位の分割文字列がkanaDictに登録されていた場合\r\n            if(separationKana[i] != \"ん\" && kanaDict[separationKana[i]]) {\r\n                //kanaDictに登録されている打ち方の内、最初の1つを挿入する\r\n                returnRomaji.push(kanaDict[separationKana[i]][0]);\r\n\r\n            //\"ん\"の処理\r\n            //separationKana[i]が\"ん\"であり、文末の場合\r\n            }else if(separationKana[i] == \"ん\" && i == separationKana.length - 1) {\r\n                //nnもしくはxnと入力する必要がある為、kanaDict[\"ん\"]の2番目を挿入する\r\n                returnRomaji.push(kanaDict[separationKana[i]][1]);\r\n\r\n            //separationKana[i]が\"ん\"であり、separationKana[i+1]があ行、な行、や行、\"ん\"の場合\r\n            }else if(i != separationKana.length - 1 && separationKana[i] == \"ん\" && judgeN.indexOf(kanaDict[separationKana[i+1]][0][0]) != -1 ) {\r\n                //nnもしくはxnと入力する必要がある\r\n                returnRomaji.push(kanaDict[separationKana[i]][1]);\r\n\r\n            //それ以外の\"ん\"の処理\r\n            }else if(separationKana[i] == \"ん\") {\r\n                //separationKana[i+1]があ行、な行、や行、\"ん\"でないのでkanaDict[\"ん\"]の最初の打ち方を挿入する\r\n                returnRomaji.push(kanaDict[separationKana[i]][0]);\r\n\r\n            }else {\r\n                //kanaDictに登録されていない場合、分割文字列の最初の1文字を除いた文字列をkanaDictから検索して代入\r\n                strList = separationKana[i].length == 2 ? kanaDict[separationKana[i][1]] : kanaDict[separationKana[i][1] + separationKana[i][2]];\r\n                //strListの要素の数だけ判定を行う\r\n                for(let j = 0; j < strList.length; j++) {\r\n                    //子音部分のローマ字を繰り返すことにより、\"っ\"を表現する\r\n                    aditionalList.push(strList[j][0] + strList[j]);\r\n                }\r\n                //returnAditionalDictに登録\r\n                returnAditionalDict[separationKana[i]] = aditionalList;\r\n                //aditionalDictに登録されている打ち方の内、最初の1つを挿入する\r\n                returnRomaji.push(returnAditionalDict[separationKana[i]][0]);\r\n                //aditionalListの初期化\r\n                aditionalList = [];\r\n            }\r\n        }\r\n        return [returnRomaji, returnAditionalDict];\r\n    }\r\n\r\n    //打キー対象のセット処理\r\n    function charInsort(){\r\n        currentChar = $('#word_romaji').text().charAt(charNum);\r\n    }\r\n\r\n\r\n    //バトル中のタイピング判定処理\r\n    function typing(key) {\r\n        let keyStr = key;\r\n\r\n        if(keyStr == \"Process\") {\r\n            return false;\r\n        }\r\n\r\n        judgeTyping += keyStr;\r\n        finishRomaji += keyStr;\r\n\r\n        //タイプしたキーが正解か不正解か判定\r\n        //表示されているローマ字と同じキーをタイプした場合\r\n        if(keyStr == currentChar){\r\n\r\n            correctType();\r\n            //\r\n            currentRomaji = currentRomaji.slice(1);\r\n\r\n        //flagNが1であり、かつnをタイプした場合も正解とする\r\n        }else if(flagN == 1 && keyStr == \"n\") {\r\n            //表示するローマ字文字列を変更\r\n            $('#word_romaji').text(finishRomaji + currentRomaji + separationRomaji.join(''));\r\n            correctType();\r\n            judgeTyping = \"\";\r\n            flagN = 0;\r\n        \r\n        //表示と異なるキーをタイプした場合\r\n        }else{\r\n            //入力中の文字列がkanaDictにあればremainingListに正解パターンを全て代入し、\r\n            //ない場合はaditionalDictのパターンを代入\r\n            if(kanaDict[currentStr]) {\r\n               remainingList = kanaDict[currentStr];\r\n            }else {\r\n                remainingList = aditionalDict[currentStr];\r\n            }\r\n            //正解パターンと照合を行う\r\n            anotherList = collationList(judgeTyping, remainingList);\r\n            if(anotherList != \"\") {\r\n                currentRomaji = anotherList[0].slice(judgeTyping.length);\r\n                //表示するローマ字文字列を変更\r\n                $('#word_romaji').text(finishRomaji + currentRomaji + separationRomaji.join(''));\r\n                correctType();\r\n\r\n            //\r\n            }else if(currentStr.length >= 2) {\r\n                remainingList = kanaDict[currentStr[0]];\r\n                anotherList = collationList(judgeTyping, remainingList);\r\n\r\n                if(anotherList != \"\") {\r\n                    nextStr = currentStr.slice(1);\r\n                    currentStr = currentStr[0];\r\n                    separationKana.unshift(nextStr);\r\n                    currentRomaji = anotherList[0].slice(judgeTyping.length);\r\n                    nextRomaji = kanaDict[nextStr][0];\r\n                    separationRomaji.unshift(nextRomaji);\r\n\r\n                    $('#word_romaji').text(finishRomaji + currentRomaji + separationRomaji.join(''));\r\n                    correctType();\r\n\r\n                }else if(currentStr.length == 3) {\r\n                    remainingList = aditionalDict[currentStr];\r\n                    anotherList = collationList(judgeTyping, remainingList);\r\n\r\n                    if(anotherList != \"\") {\r\n                        nextStr = currentStr[2];\r\n                        currentStr.pop();\r\n                        separationKana.unshift(nextStr);\r\n                        currentRomaji = anotherList[0].slice(judgeTyping.length);\r\n                        nextRomaji = kanaDict[nextStr][0];\r\n                        separationRomaji.unshift(nextRomaji);\r\n\r\n                        $('#word_romaji').text(finishRomaji + currentRomaji + separationRomaji.join(''));\r\n                        correctType();\r\n\r\n                    }else {\r\n                        missType();\r\n                    }\r\n\r\n                }else {\r\n                    missType();\r\n                }\r\n            }else {\r\n                missType();\r\n            }\r\n            flagN = 0;\r\n        }\r\n\r\n        function collationList(judgeTyping, remainingList) {\r\n            //照合する打ち方を格納する変数\r\n            let returnAnotherList = [];\r\n            //remainingListの要素の数の分照合を行う\r\n            for(let i = 0; i < remainingList.length; i++) {\r\n\r\n                if(remainingList[i].startsWith(judgeTyping)) {\r\n                    returnAnotherList.push(remainingList[i]);\r\n                }\r\n            }\r\n\r\n            return returnAnotherList;\r\n        }\r\n\r\n        function correctType() {\r\n            //正解音と不正解音をリセットし、正解音を鳴らす\r\n            //document.getElementById('missaudio').pause();\r\n            $('#missAudio')[0].currentTime = 0;\r\n            //document.getElementById('correctaudio').pause();\r\n            $('#correctAudio')[0].currentTime = 0;\r\n            $('#correctAudio')[0].play();\r\n            //正解した文字の色を切り替える\r\n            $('#word_romaji').html(\"<span style='color: red;'>\" + $('#word_romaji').text().substr(0, charNum+1) + \"</span>\" + $('#word_romaji').text().substr(charNum + 1, $('#word_romaji').text().length));\r\n            //次の文字のセットと正解数のカウントアップ\r\n            charNum++;\r\n            correctCount++;\r\n\r\n            $('#monster_hp').text(parseInt($('#monster_hp').text()) - strike);\r\n            if($('#monster_hp').text() <= 0) {\r\n                $('#monster_hp').text(0);\r\n                victory();\r\n            }\r\n            charInsort();\r\n        }\r\n\r\n        function missType() {\r\n            //正解音と不正解音をリセットし、不正解音を鳴らす\r\n            //document.getElementById('missaudio').pause();\r\n            $('#missAudio')[0].currentTime = 0;\r\n            //document.getElementById('correctaudio').pause();\r\n            $('#correctAudio')[0].currentTime = 0;\r\n            $('#missAudio')[0].play();\r\n            //不正解数のカウントアップ\r\n            mistakeCount++;\r\n            finishRomaji = finishRomaji.slice(0, -1);\r\n            judgeTyping = judgeTyping.slice(0, -1);\r\n\r\n            $('#player_hp').text(parseInt($('#player_hp').text()) - mistakeDamage);\r\n            $('#battle_text').append(\"<br>タイプミス！ \" + user.name + \" は \" + mistakeDamage + \" のダメージ！\");\r\n            if($('#player_hp').text() <= 0) {\r\n                $('#player_hp').text(0);\r\n                gameover();\r\n            }\r\n            textScroll();    \r\n        }\r\n\r\n        if(currentRomaji == \"\") {\r\n            currentRomaji = separationRomaji.shift();\r\n            currentStr = separationKana.shift();\r\n\r\n            if(judgeTyping == \"n\" && (fieldData.id != 2 || field.id != 4)) {\r\n                flagN = 1;\r\n            }else {\r\n                flagN = 0;\r\n            }\r\n\r\n            judgeTyping = \"\";\r\n        }\r\n\r\n        //次の問題の出題処理\r\n        if($('#monster_hp').text() != 0 && $('#player_hp').text() != 0 && charNum == $('#word_romaji').text().length){\r\n            charNum = 0;\r\n            judgeTyping = [];\r\n            finishRomaji = [];\r\n            setQuestion();\r\n        }\r\n    }\r\n\r\n    //モンスターの攻撃カウント処理\r\n    function monsterAttackCount(){\r\n        //timeRemaining変数にmonster.attack_intervalを代入する\r\n        timeRemaining = monster.attack_interval;\r\n\r\n        $('#count').html(\"モンスターの攻撃まであと <span class='time'>\" + timeRemaining + \"</span> 秒\");\r\n\r\n        clearInterval(attackTimer);\r\n        //モンスターの攻撃カウントダウン処理\r\n        attackTimer = setInterval(function(){\r\n            if(parseInt($('#player_hp').text()) <= 0 || parseInt($('#monster_hp').text()) <= 0){\r\n                return false;\r\n            }\r\n\r\n            if(status == 2) {\r\n                timeRemaining--;\r\n                $('#count').html(\"モンスターの攻撃まであと <span class='time'>\" + timeRemaining + \"</span> 秒\");\r\n                if(timeRemaining <= 0){\r\n                    clearInterval(attackTimer);\r\n                    //モンスター攻撃処理\r\n                    monsterAttack();\r\n                }\r\n            }\r\n        }, 1000);\r\n    }\r\n\r\n    //モンスターの攻撃処理\r\n    function monsterAttack() {\r\n        //player.hpの減少処理\r\n        $('#player_hp').html(parseInt($('#player_hp').text()) - damage);\r\n\r\n        $('#attackAudio')[0].play();\r\n\r\n        $('#battle_text').append(`<br>${monster.name}の攻撃！ ${user.name} は ${damage} のダメージ！`);\r\n\r\n        textScroll();\r\n\r\n        if($('#player_hp').text() <= 0){\r\n            $('#player_hp').text(0);\r\n            gameover();\r\n        }\r\n\r\n        monsterAttackCount();\r\n    }\r\n\r\n\r\n\r\n    //以下バトル勝利～勝利後の処理 status=3\r\n\r\n    //勝利処理\r\n    function victory(){\r\n        //モンスター攻撃カウントと問題文を非表示にする\r\n        $('#count').hide();\r\n        $('#word').hide();\r\n        $('#word_kana').hide();\r\n        $('#word_romaji').hide();\r\n        \r\n        //戦闘BGMを停止し、勝利BGMを流す\r\n        $('#battleAudio')[0].pause();\r\n        $('#battleAudio')[0].currentTime = 0;\r\n        $('#victoryAudio')[0].play();\r\n        $('#victoryAudio')[0].volume = 0.4;\r\n        $('.victoryVoice')[0].play();\r\n        $('#battle_text').append(\"<br>\" + monster.name + \"をたおした！\");\r\n        $('#monster_image').css('visibility', 'hidden');\r\n        textScroll();\r\n\r\n        //スコアを計算し表示\r\n        score = Math.ceil(monster.hp * (correctCount/(correctCount+mistakeCount)) - (mistakeCount * mistakeDamage));\r\n\r\n        //勝利カウントを増やす\r\n        switch(field.id) {\r\n            case 1:\r\n                player.field1_victory_count++;\r\n                nextFieldFlag1 = 1;\r\n                break;\r\n            case 2:\r\n                player.field2_victory_count++;\r\n                nextFieldFlag2 = 1;\r\n                break;\r\n            case 3:\r\n                player.field3_victory_count++;\r\n                nextFieldFlag3 = 1;\r\n                break;\r\n            case 4:\r\n                player.field4_victory_count++;\r\n                nextFieldFlag4 = 1;\r\n                break;\r\n            case 5:\r\n                player.field5_victory_count++;\r\n                break;\r\n        }\r\n\r\n        $('#scoredis').show();\r\n        $('#press_enter').show();\r\n        $('#scoredis').html(\"スコア： \" + score + \"点<hr>正タイプ数： \" + correctCount + \"<br>ミスタイプ数： \" + mistakeCount);\r\n\r\n        status = 3;\r\n    }\r\n\r\n    //経験値獲得処理\r\n    function addExp() {\r\n        $('#battle_text').append(\"<br>\" + user.name + \"は \" + monster.exp + \" の経験値を得た\");\r\n        textScroll();\r\n        //ドロップ判定\r\n        //ドロップアイテムを既に持っている場合はドロップしない\r\n        let havingItemsId = [];\r\n        for(let i = 0; i < havingItems.length; i++) {\r\n            havingItemsId.push(havingItems[i].id);\r\n        }\r\n        judgeHaving = $.inArray(dropItem.id, havingItemsId);\r\n\r\n        if(judgeHaving < 0) {\r\n            judgeDrop = parseInt(Math.random() * 5);\r\n        }else {\r\n            judgeDrop = 1;\r\n        }\r\n\r\n        if(judgeDrop == 0) {\r\n            player.get_item = dropItem.id;\r\n        }else {\r\n            player.get_item = \"\";\r\n        }\r\n\r\n        //レベルアップ判定とアイテムドロップ判定\r\n        if(player.next_exp <= monster.exp) {\r\n            displayEnter = 1;\r\n        }else if(judgeDrop == 0) {\r\n            player.next_exp -= monster.exp;\r\n            displayEnter = 4;\r\n        }else {\r\n            player.next_exp -= monster.exp;\r\n            displayEnter = 5;\r\n        }\r\n    }\r\n\r\n    //レベルアップ処理\r\n    function levelUp() {\r\n        let getExp = monster.exp;\r\n        player.exp += getExp;\r\n\r\n        for(let i = player.level; ; i++) {\r\n\r\n            if(getExp < player.next_exp) {\r\n                player.next_exp -= getExp;\r\n                player.level += levelUpCount;\r\n                bonusPoint = levelUpCount;\r\n                break;\r\n            }\r\n\r\n            getExp -= player.next_exp;\r\n            player.next_exp = nextExp(i);\r\n            levelUpCount++;\r\n        }\r\n\r\n        $('#battle_text').append(`<br>${user.name} は レベル <span style=\"color: yellow\">${player.level}</span> に上がった！`);\r\n        textScroll();\r\n\r\n        displayEnter = 2;\r\n    }\r\n\r\n    //レベルアップ時のHP成長とボーナスポイントを振り分ける処理\r\n    function addStatusSelect() {\r\n        let growHp = 0;\r\n        for(let i = 0; i < levelUpCount; i++) {\r\n            growHp += parseInt(Math.random() * 5 + 5);\r\n        }\r\n\r\n        player.hp += growHp;\r\n        $('#battle_text').append(`<br>さいだいHPが<span style=\"color: yellow\"> ${growHp} </span>上がった！`);\r\n        divideBonusPoint();\r\n\r\n        $('#press_enter').hide();\r\n        displayEnter = 3;\r\n        levelUpCount = 0;\r\n    }\r\n\r\n    //ボーナスポイント振り分け選択処理\r\n    function divideBonusPoint() {\r\n        if(bonusPoint == 0) {\r\n            $('#press_enter').show();\r\n\r\n            if(judgeDrop == 0) {\r\n                displayEnter = 4;\r\n            }else {\r\n                displayEnter = 5;\r\n            }\r\n        }else {\r\n            $('#battle_text').append(\"<br>成長させるステータスを選んでください  ボーナスポイント残り \"\r\n            + bonusPoint + \"<br>HP(\" + player.hp + \"→\" + (player.hp + 10) + \")：1ボタン　攻撃力(\" + player.attack + \"→\" + (player.attack + 1)\r\n            + \")：2ボタン　防御力(\" + player.defence + \"→\" + (player.defence + 2) + \")：3ボタン\");\r\n            textScroll();\r\n        }\r\n    }\r\n\r\n    //HP成長を選んだ際の処理\r\n    function addHp() {\r\n        player.hp += 10;\r\n        $('#battle_text').append(\"<br>さらに、さいだいHPが<span style='color: yellow'> 10 </span>上がった！\");\r\n        textScroll();\r\n        bonusPoint--;\r\n\r\n        divideBonusPoint();\r\n    }\r\n\r\n    //攻撃力成長を選んだ際の処理\r\n    function addAttack() {\r\n        player.attack++;\r\n        $('#battle_text').append(\"<br>さらに、攻撃力が<span style='color: yellow'> 1 </span>上がった！\");\r\n        textScroll();\r\n        bonusPoint--;\r\n\r\n        divideBonusPoint();\r\n    }\r\n\r\n    //防御力成長を選んだ際の処理\r\n    function addDefence() {\r\n        player.defence += 2;\r\n        $('#battle_text').append(\"<br>さらに、防御力が<span style='color: yellow'> 2 </span>上がった！\");\r\n        textScroll();\r\n        bonusPoint--;\r\n\r\n        divideBonusPoint();\r\n    }\r\n\r\n    //アイテム獲得処理\r\n    function itemDrop() {\r\n\r\n        $('#battle_text').append(\"<br><span style='color: lime'>\" + dropItem.name + \" </span>を手に入れた！\");\r\n        textScroll();\r\n\r\n        displayEnter = 5;\r\n    }\r\n\r\n    //勝利後のデータを保存する処理\r\n    function dataSave() {\r\n        $('#battle_text').append(\"<br>データを保存しています・・・\");\r\n        textScroll();\r\n\r\n        $.ajax({\r\n            url: '/setdata',\r\n            type: 'POST',\r\n            dataType: 'text',\r\n            contentType: \"application/json\",\r\n            data: JSON.stringify(\r\n                player,\r\n            ),\r\n        })\r\n        .done(function() {\r\n            $('#battle_text').append(\"<br>データを保存しました。\");\r\n            if(player.field1_victory_count == 5 && nextFieldFlag1 == 1) {\r\n                $('#battle_text').append(\"<br>新たなフィールド <span style='color: yellow'>森林地帯</span> が解放されました！\");\r\n                releaseField();\r\n            }else if(player.field2_victory_count == 5 && nextFieldFlag2 == 1) {\r\n                $('#battle_text').append(\"<br>新たなフィールド <span style='color: yellow'>荒野地帯</span> が解放されました！\");\r\n                releaseField();\r\n            }else if(player.field3_victory_count == 5 && nextFieldFlag3 == 1) {\r\n                $('#battle_text').append(\"<br>新たなフィールド <span style='color: yellow'>山岳地帯</span> が解放されました！\");\r\n                releaseField();\r\n            }else if(player.field4_victory_count == 5 && nextFieldFlag4 == 1) {\r\n                $('#battle_text').append(\"<br>新たなフィールド <span style='color: yellow'>魔界</span> が解放されました！\");\r\n                releaseField();\r\n            }\r\n            textScroll();\r\n            displayEnter = 0;\r\n            status = 4;\r\n            judgeEnter = 0;\r\n        })\r\n        .fail(function(response) {\r\n            console.log(response)\r\n            $('#battle_text').append(\"<br>データの保存に失敗しました。再度通信を行う場合はEnterキーを押してください。\");\r\n            textScroll();\r\n            judgeEnter = 0;\r\n        });\r\n\r\n    }\r\n    \r\n\r\n\r\n    //以下バトル敗北処理\r\n\r\n    //敗北処理\r\n    function gameover(){\r\n        //モンスター攻撃カウントと問題文を非表示にする\r\n        $('#count').hide();\r\n        $('#word').hide();\r\n        $('#word_kana').hide();\r\n        $('#word_romaji').hide();\r\n\r\n        //戦闘BGMを停止し、敗北BGMを流す\r\n        $('#battleAudio')[0].pause();\r\n        $('#battleAudio')[0].currentTime = 0;\r\n        $('#loseAudio')[0].play();\r\n        $('#loseAudio')[0].volume = 0.4;\r\n        $('.loseVoice')[0].play();\r\n\r\n        //敗北テキストの表示\r\n        $('#battle_text').append(\"<br>\" + monster.name + \"にやぶれた・・・\");\r\n\r\n        $('#press_enter').show();\r\n\r\n        //プレイヤー画像を非表示にする\r\n        $('#player_image').css('visibility', 'hidden');\r\n        textScroll();\r\n\r\n        player.get_item = \"\";\r\n        status = 4;\r\n    }\r\n\r\n\r\n\r\n    //以下バトル終了後の次の行動を選択する処理 status=4\r\n\r\n    //次の行動を選択する処理\r\n    function selectNextAction() {\r\n        $('#press_enter').hide();\r\n        $('#scoredis').hide();\r\n\r\n        $('#battle_text').append(\"<br>次の行動を選択してください。\");\r\n        textScroll();\r\n\r\n        let victoryFlg = victoryCount();\r\n        if(victoryFlg != victoryCnt) {\r\n            $('#shareing_twitter').attr('href', `https://twitter.com/share?url=https://typing-rpg.com/login&hashtags=TypingRPG&text=${monster.name}をスコア${score}で倒しました！`);\r\n            $('.shareing_sns').show();\r\n        }else {\r\n            $('#shareing_twitter').attr('href', '');\r\n            $('.shareing_sns').hide();\r\n        }\r\n        $('.select_next_action').css('display', 'flex');\r\n\r\n        battleInit();\r\n    }\r\n\r\n    //次のバトルを選択した際の処理\r\n    $('#next_battle').on('click', function() {\r\n        getData();\r\n    });\r\n\r\n    //フィールドの変更を選択した際の処理\r\n    $('#change_field').on('click', function() {\r\n        $('#change_field_btn').trigger('click');\r\n    })\r\n\r\n    //装備の変更ボタンを選択した際の処理\r\n    $('#change_equipment').on('click', function() {\r\n        $('#change_equipment_btn').trigger('click');\r\n    });\r\n\r\n\r\n\r\n    //以下システム処理やメインページの各ボタンを押した際の処理\r\n\r\n    //バトル中に使用した変数を初期化\r\n    function battleInit() {\r\n        //各変数の初期化\r\n        questions = [];\r\n        monster = [];\r\n        dropItem = [];\r\n        user = [];\r\n        field = [];\r\n        havingItems = [];\r\n        status = 0;\r\n        displayEnter = 0;\r\n        readyTime = 3;\r\n        words = [];\r\n        wordsKana = [];\r\n        separationKana = [];\r\n        separationRomaji = [];\r\n        aditionalDict = [];\r\n        correctCount = 0;\r\n        mistakeCount = 0;\r\n        score = 0;\r\n        judgeTyping = [];\r\n        finishRomaji = [];\r\n        flagN = 0;\r\n        levelUpCount = 0;\r\n        bonusPoint = 0;\r\n        currentChar = \"\";\r\n        charNum = 0;\r\n        timeRemaining = 0;\r\n        nextFieldFlag1 = 0;\r\n        nextFieldFlag2 = 0;\r\n        nextFieldFlag3 = 0;\r\n        nextFieldFlag4 = 0;\r\n        $('#change_equipment_btn').prop('disabled', false);\r\n        $('#change_equipment_btn').css('color', 'white');\r\n        $('#change_field_btn').prop('disabled', false);\r\n        $('#change_field_btn').css('color', 'white');\r\n    }\r\n\r\n    //statusの値によってキーボードを押した際の動作を分ける\r\n    $('body').on('keydown', function(e) {\r\n\r\n        //バトル開始前\r\n        if(status == 1 && e.key == ' ') {\r\n            if(infoFlag == 1) {\r\n                return false;\r\n            }\r\n            $('#battle_btn').trigger('click');\r\n        }\r\n\r\n        //バトル中\r\n        if(status == 2) {\r\n            if(infoFlag == 1) {\r\n                return false;\r\n            }\r\n\r\n            if(e.key == \"Escape\") {\r\n                $('#battle_reset').trigger('click');\r\n            }else {\r\n                typing(e.key);\r\n            }\r\n        }\r\n\r\n        //バトル勝利後\r\n        if(status == 3 && displayEnter == 3) {\r\n            if(infoFlag == 1) {\r\n                return false;\r\n            }\r\n\r\n            if(e.key == 1) {\r\n                addHp();\r\n            }else if(e.key == 2) {\r\n                addAttack();\r\n            }else if(e.key == 3) {\r\n                addDefence();\r\n            }else if(e.key == \"Enter\"){\r\n                return false;\r\n            }\r\n        }\r\n\r\n        if(status == 3 && e.key == \"Enter\") {\r\n            if(judgeEnter == 1 || infoFlag == 1) {\r\n                return false;\r\n            }\r\n\r\n            if(displayEnter == 0) {\r\n                addExp();\r\n            }else if(displayEnter == 1) {\r\n                levelUp();\r\n            }else if(displayEnter == 2) {\r\n                addStatusSelect();\r\n            }else if(displayEnter == 4) {\r\n                itemDrop();\r\n            }else {\r\n                judgeEnter = 1;\r\n                dataSave();\r\n            }\r\n        }\r\n\r\n        //バトル敗北または勝利後の経験値取得やレベルアップ処理後\r\n        if(status == 4 && e.key == \"Enter\") {\r\n            selectNextAction();\r\n        }\r\n    });\r\n\r\n\r\n    //所持アイテム一覧の取得と表示処理\r\n    function getHavingItem() {\r\n        $.ajax({\r\n            url: '/getitem',\r\n            type: 'POST',\r\n        })\r\n        .done(function(response) {\r\n            havingItems = response.items;\r\n            equipItem = response.equip_item;\r\n            let i;\r\n            let html = \"\";\r\n            \r\n            for(i = 0; i < havingItems.length; i++) {\r\n                html += `<li class=\"having_item\" data-id=\"${havingItems[i].id}\">\r\n                            <div class=\"item_image\">\r\n                                <img src=\"/images/item_images/${havingItems[i].image}\" alt=\"${havingItems[i].name}\">\r\n                                <p>${havingItems[i].name}</p>\r\n                            </div>\r\n                            <div class=\"item_detail\">\r\n                                <p><i class=\"far fa-hand-rock\"></i>：<span>${havingItems[i].attack}</span></p>\r\n                                <p><i class=\"fas fa-shield-alt\"></i>：<span>${havingItems[i].defence}</span></p>\r\n                                <p><i class=\"far fa-tired\"></i>：<span>${havingItems[i].mistake_damage}</span></p>\r\n                            </div>\r\n                        </li>`;\r\n            }\r\n\r\n            $('.having_items_list').empty().append(html);\r\n            setEquip();\r\n            \r\n            $('.equipment_display').show();\r\n            $('#battle_text').append(\"<br>装備するアイテムを選択してください。\");\r\n        })\r\n        .fail(function(response) {\r\n            console.log(response)\r\n            $('#battle_text').append(\"<br>データの取得に失敗しました。\");\r\n            textScroll();\r\n        });\r\n    }\r\n\r\n    //装備中のアイテムをオレンジの枠で囲む処理\r\n    function setEquip() {\r\n        $('.equip').removeClass('equip');\r\n\r\n        if(equipItem != null) {\r\n            $('.having_item').filter(function() {\r\n                return($(this).data('id') == equipItem.id);\r\n            })\r\n            .addClass('equip');\r\n        }\r\n    }\r\n\r\n    //所持アイテムの装備着脱処理\r\n    $(document).on('click', '.having_item', function() {\r\n        let itemId = {'id': $(this).data('id')}\r\n\r\n        if(equipItem != null && equipItem.id == itemId.id) {\r\n            itemId = {'id': ''};\r\n        }else {\r\n            itemId = {'id': $(this).data('id')};\r\n        }\r\n\r\n        $.ajax({\r\n            url: '/setitem',\r\n            type: 'POST',\r\n            contentType: \"application/json\",\r\n            data: JSON.stringify(\r\n                itemId,\r\n            ),\r\n        })\r\n        .done(function(response) {\r\n            //equipItemの書き換え\r\n            equipItem = response.item;\r\n            //プレイヤーステータスの書き換え\r\n            setPlayerStatus();\r\n\r\n            if(equipItem != null) {\r\n                $('#battle_text').append(\"<br>\" + equipItem.name + \" を装備しました。\");\r\n            }else {\r\n                $('#battle_text').append(\"<br>装備を外しました。\");\r\n            }\r\n\r\n            setEquip();\r\n            textScroll();\r\n        })\r\n        .fail(function(response) {\r\n            console.log(response);\r\n            $('#battle_text').append(\"<br>通信に失敗しました。\");\r\n            textScroll();\r\n        });\r\n    });\r\n\r\n    //装備選択画面を閉じる\r\n    $('.close_equipment').on('click', function() {\r\n        $('.equipment_display').hide();\r\n    });\r\n\r\n    $('#change_equipment_btn').on('click', function() {\r\n        $('#battle_text').append(\"<br>所持アイテムを取得中・・・\");\r\n        textScroll();\r\n\r\n        getHavingItem();\r\n    });\r\n\r\n    //ヘッダーのフィールド変更ボタンを押した際の処理\r\n    $('#change_field_btn').on('click', function() {\r\n        $('.select_next_action').hide();\r\n        $('.equipment_display').hide();\r\n        $('#battle_btn').hide();\r\n        $('.select_field_display').show();\r\n        fieldData = new FormData();\r\n\r\n        $('#battle_text').html(\"フィールドを選択してください。\");\r\n        status = 0;\r\n    });\r\n\r\n    //ヘッダーのバトルのリセットボタンを押した際の処理\r\n    $('#battle_reset').on('click', function() {\r\n        if(status != 2) {\r\n            return false;\r\n        }\r\n        clearInterval(attackTimer);\r\n        $('#change_equipment_btn').prop('disabled', false);\r\n        $('#change_equipment_btn').css('color', 'white');\r\n        $('#change_field_btn').prop('disabled', false);\r\n        $('#change_field_btn').css('color', 'white');\r\n        $('#count').hide();\r\n        $('#word').hide();\r\n        $('#word_kana').hide();\r\n        $('#word_romaji').hide();\r\n        $('#battleAudio')[0].pause();\r\n        $('#battleAudio')[0].currentTime = 0;\r\n        $('#player_hp').text(player.hp);\r\n        $('#monster_hp').text(monster.hp);\r\n        $('#battle_text').html(\"バトルをリセットしました。<br>BATTLE STARTボタンをクリック または スペースキーを押して戦闘開始\");\r\n        $('#battle_btn').show();\r\n        correctCount = 0;\r\n        mistakeCount = 0;\r\n        currentChar = \"\";\r\n        charNum = 0;\r\n        judgeTyping = [];\r\n        finishRomaji = [];\r\n        timeRemaining = 0;\r\n\r\n        status = 1;\r\n    });\r\n\r\n    //インフォメーションボタンを押した際の処理\r\n    $('#show_info').on('click', function() {\r\n        $('#game_tab').prop('checked', true);\r\n        infoFlag = 1;\r\n        //インフォメーションモーダルを開く\r\n        $('.info_modal').show();\r\n    })\r\n\r\n    //インフォメーションモーダルを閉じる処理\r\n    $('.modal_close').on('click', function() {\r\n        infoFlag = 0;\r\n        $('.info_modal').hide();\r\n    })\r\n\r\n    //新たなフィールドを解放する処理\r\n    function releaseField() {\r\n        if(player.field1_victory_count >= 5) {\r\n            $('#field2').removeClass('not_select');\r\n            $('#field2').prop('disabled', false);\r\n        }\r\n        if(player.field2_victory_count >= 5) {\r\n            $('#field3').removeClass('not_select');\r\n            $('#field3').prop('disabled', false);\r\n        }\r\n        if(player.field3_victory_count >= 5) {\r\n            $('#field4').removeClass('not_select');\r\n            $('#field4').prop('disabled', false);\r\n        }\r\n        if(player.field4_victory_count >= 5) {\r\n            $('#field5').removeClass('not_select');\r\n            $('#field5').prop('disabled', false);\r\n        }\r\n    }\r\n\r\n    //選択したフィールドでの勝利数を返す\r\n    function victoryCount() {\r\n        switch(field.id) {\r\n            case 1:\r\n                return player.field1_victory_count;\r\n            case 2:\r\n                return player.field2_victory_count;\r\n            case 3:\r\n                return player.field3_victory_count;\r\n            case 4:\r\n                return player.field4_victory_count;\r\n            case 5:\r\n                return player.field5_victory_count;\r\n        }\r\n    }\r\n\r\n    //経験値テーブルの計算処理\r\n    function nextExp(currentLv) {\r\n        let returnExp = 0;\r\n        if(currentLv >= 40) {\r\n            returnExp = (currentLv - 40) * 10 + 160;\r\n        }else if(currentLv < 40 && currentLv >= 20) {\r\n            returnExp = (currentLv - 20) * 5 + 60;\r\n        }else {\r\n            returnExp = (currentLv + 1) * 3;\r\n        }\r\n\r\n        return returnExp;\r\n    }\r\n\r\n    //テキストを最下部へ自動スクロールする処理\r\n    function textScroll(){\r\n        battle_text.scroll(0, battle_text.scrollHeight);\r\n    }\r\n});\r\n"],"sourceRoot":""}